!function(){function a(a,d){var e=a[d];a[d]=function(a){var d,f=!1,g=!1;if(a.match(c)){a=a.replace(c,""),this.parentNode||(b.appendChild(this),g=!0);var h=this.parentNode;return this.id||(this.id="rootedQuerySelector_id_"+(new Date).getTime(),f=!0),d=e.call(h,"#"+this.id+" "+a),f&&(this.id=""),g&&b.removeChild(this),d}return e.call(this,a)}}if(!HTMLElement.prototype.querySelectorAll)throw new Error("rootedQuerySelectorAll: This polyfill can only be used with browsers that support querySelectorAll");var b=document.createElement("div");try{b.querySelectorAll(":scope *")}catch(b){var c=/^\s*:scope/gi;a(HTMLElement.prototype,"querySelector"),a(HTMLElement.prototype,"querySelectorAll")}}();var html5Upload=function(){"use strict";function a(a){var b=this;b.dropContainer=a.dropContainer,b.inputField=a.inputField,b.uploadsQueue=[],b.activeUploads=0,b.data=a.data,b.key=a.key,b.maxSimultaneousUploads=a.maxSimultaneousUploads||-1,b.onFileAdded=a.onFileAdded||e,b.uploadUrl=a.uploadUrl,b.onFileAddedProxy=function(a){f.log("Event: onFileAdded, file: "+a.fileName),b.onFileAdded(a)},b.initialize()}function b(a){var b=this;b.file=a,b.fileName=a.name,b.fileSize=a.size,b.uploadSize=a.size,b.uploadedBytes=0,b.eventHandlers={},b.events={onProgress:function(a,c){var d=c/a*100;f.log("Event: upload onProgress, progress = "+d+", fileSize = "+a+", uploadedBytes = "+c),(b.eventHandlers.onProgress||e)(d,a,c)},onStart:function(){f.log("Event: upload onStart"),(b.eventHandlers.onStart||e)()},onCompleted:function(c){f.log("Event: upload onCompleted, data = "+c),a=null,(b.eventHandlers.onCompleted||e)(c)}}}var c,d={},e=function(){},f=window.console||{log:e};return b.prototype={on:function(a){this.eventHandlers=a}},a.prototype={initialize:function(){f.log("Initializing upload manager");var a=this,b=a.dropContainer,c=a.inputField,d=function(a){a.preventDefault(),a.stopPropagation()},e=function(a){d(a),b.classList.add("drag-over")},g=function(a){d(a),b.classList.remove("drag-over")};b&&(a.on(b,"dragenter",e),a.on(b,"dragover",e),a.on(b,"dragleave",g),a.on(b,"drop",function(b){d(b),g(b),a.processFiles(b.dataTransfer.files)})),c&&a.on(c,"change",function(){a.processFiles(this.files)})},processFiles:function(a){f.log("Processing files: "+a.length);var c,d,e,g=this,h=a.length;for(e=0;h>e;e+=1){if(c=a[e],0===c.size){alert("Files with files size zero cannot be uploaded or multiple file uploads are not supported by your browser");break}d=new b(c),g.uploadFile(d)}},uploadFile:function(a){var b=this;return b.onFileAdded(a),b.activeUploads===b.maxSimultaneousUploads?(f.log("Queue upload: "+a.fileName),void b.uploadsQueue.push(a)):void b.ajaxUpload(a)},ajaxUpload:function(a){var b,c,d,e,g=this,h=a.file,i=g.data,j=g.key||"file";if(f.log("Beging upload: "+a.fileName),g.activeUploads+=1,b=new window.XMLHttpRequest,c=new window.FormData,d=h.name,b.open("POST",g.uploadUrl),b.upload.onloadstart=function(){f.log("Upload started: "+d),a.events.onStart()},b.upload.onprogress=function(b){b.lengthComputable&&a.events.onProgress(b.total,b.loaded)},b.onload=function(b){f.log("Upload completed: "+d),g.activeUploads-=1,a.events.onCompleted(b.target.responseText),g.uploadsQueue.length&&g.ajaxUpload(g.uploadsQueue.shift())},b.onerror=function(){f.log("Upload failed: ",a.fileName)},i)for(e in i)i.hasOwnProperty(e)&&(f.log("Adding data: "+e+" = "+i[e]),c.append(e,i[e]));c.append(j,h),b.send(c)},on:function(a,b,c){a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c)}},d.fileApiSupported=function(){if("boolean"!=typeof c){var a=document.createElement("input");a.setAttribute("type","file"),c=!!a.files}return c},d.initialize=function(b){return new a(b)},d}();!function(){function a(a,d){var e=a[d];a[d]=function(a){var d,f=!1,g=!1;if(a.match(c)){a=a.replace(c,""),this.parentNode||(b.appendChild(this),g=!0);var h=this.parentNode;return this.id||(this.id="rootedQuerySelector_id_"+(new Date).getTime(),f=!0),d=e.call(h,"#"+this.id+" "+a),f&&(this.id=""),g&&b.removeChild(this),d}return e.call(this,a)}}if(!HTMLElement.prototype.querySelectorAll)throw new Error("rootedQuerySelectorAll: This polyfill can only be used with browsers that support querySelectorAll");var b=document.createElement("div");try{b.querySelectorAll(":scope *")}catch(b){var c=/^\s*:scope/gi;a(HTMLElement.prototype,"querySelector"),a(HTMLElement.prototype,"querySelectorAll")}}();var matches=function(a,b){return(a.matches||a.matchesSelector||a.msMatchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.oMatchesSelector).call(a,b)},getClosest=function(a,b){for(;a&&a!==document;a=a.parentNode)if(matches(a,b))return a;return!1},getParents=function(a,b){for(var c=[];a&&a!==document;a=a.parentNode)(!b||b&&matches(a,b))&&c.push(a);return c.length?c:null};Array.prototype.equals=function(a){if(!a)return!1;if(this.length!=a.length)return!1;for(var b=0,c=this.length;c>b;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b]))return!1}else if(this[b]!=a[b])return!1;return!0};var AJAX=function(){function a(){this.x=new XMLHttpRequest}return a.prototype.send=function(a,b,c,d,e,f){void 0===e&&(e=!0),void 0===f&&(f=[]);var g=this;if(this.x.open(a,b,e),this.x.onreadystatechange=function(){4==g.x.readyState&&d(this.responseText)},"POST"==a&&this.x.setRequestHeader("Content-type","application/x-www-form-urlencoded"),void 0!==f&&null!==f&&void 0!==f.length&&f.length)for(var h=0;h<f.length;h++){var i=f[h];for(var j in i)i.hasOwnProperty(j)&&this.x.setRequestHeader(j,i[j])}this.x.send(c)},a.prototype.get=function(a,b,c,d,e){void 0===d&&(d=!0),void 0===e&&(e=[]);var f=[];for(var g in b)f.push(encodeURIComponent(g)+"="+encodeURIComponent(b[g]));this.send("GET",a+(a.indexOf("?")>0?"&":"?")+f.join("&"),null,c,d,e)},a.prototype.post=function(a,b,c,d){void 0===d&&(d=!0);var e=[];for(var f in b)e.push(encodeURIComponent(f)+"="+encodeURIComponent(b[f]));this.send("POST",a,e.join("&"),c,d,void 0!==b.headers?b.headers:null)},a.prototype.setHeaders=function(a){for(var b=0;b<a.length;b++){var c=a[b];for(var d in c)c.hasOwnProperty(d)&&this.x.setRequestHeader(d,c[d])}},a}(),_EUREKA={src:function(){var a=document.getElementsByTagName("script"),b=a[a.length-1].src;return b}()},Eureka=function(){function a(a){this.opts=a;var b=this;this._model=new EurekaModel(a),this._view=new EurekaView,this._controller=new EurekaController({model:this._model,view:this._view}),this._model.setController(this._controller),this._view.setController(this._controller),this._view.init(),this._view.paint(),this._controller.init(),this.fetch(!0,!1,!0),this._view.getElement().addEventListener("EurekaFilesUploaded",function(a){b._model.setCurrentDirectory(b._model.getCurrentDirectory(),!0,!0,!0)})}return a.prototype.fetch=function(a,b,c){void 0===a&&(a=!0),void 0===b&&(b=!0),void 0===c&&(c=!0);var d=void 0!==this._model.getCurrentMediaSource()&&""!==this._model.getCurrentMediaSource()?!0:!1;d=!0,this._model.getDebug()&&console.log("fetch ",a,b,c),this._model.getDebug()&&console.log("_shouldFetchDirectory "+d),this._model.setCurrentMediaSource(this._model.getCurrentMediaSource(),a,b,!1,c),d&&this._model.setCurrentDirectory(this._model.getCurrentDirectory(),a,b,c)},a.prototype.getElement=function(){return this._view.getElement()},a}(),EurekaMediaSource=function(){function a(a){this.opts=a,this._id="",this._title="",void 0!==a.id&&(this._id=a.id),void 0!==a.title&&(this._title=a.title)}return a.prototype.getID=function(){return this._id},a.prototype.setID=function(a){this._id=a},a.prototype.getTitle=function(){return this._title},a.prototype.setTitle=function(a){this._title=a},a.prototype.toString=function(){return this.getID()},a}(),EurekaModel=function(){function a(a){this._uid="media-browser_0",this._storagePrefix="eureka_",this._sources=[],this._navTreeHidden=!1,this._useLocalStorage=!0,this._currentDirectory=void 0,this._currentView="view-a",this._locale="en-US",this._selected="",this._editable=!0,this._headers=[],this._debug=!1,this._confirmBeforeDelete=!0,this._displayFullTreePaths=!1,this._allowRename=!0,this._allowDelete=!0,this._touch=!1,this._prependOptGroupsWithRootOption=!0,this._showDimensionsColumn=!0,this._webWorkersPath="",this._directoryRequestURL="",this._directoryChildrenRequestURL="",this._listSourceRequestURL="",this._listSourcesRequestURL="",this._useWebWorkers=!1,this._sortMediaSources=!1,this._fullscreenTarget=".eureka-wrapper",this._mediaSourcesListInit=!1,this._mediaSourceInit=!1,this.getXHRHeaders=function(){return this._headers},void 0!==a.uid&&(this._uid=a.uid),void 0!==a.storagePrefix&&(this._storagePrefix=a.storagePrefix),void 0!==a.locale&&(this._locale=a.locale),void 0!==a.mediaSource&&(this._mediaSource=a.mediaSource),void 0!==a.currentDirectory&&(this._currentDirectory=a.currentDirectory),void 0!==a.headers&&(this._headers=a.headers),void 0!==a.navTreeHidden&&(this._navTreeHidden=a.navTreeHidden),void 0!==a.useLocalStorage&&(this._useLocalStorage=a.useLocalStorage),void 0!==a.currentView&&(this._currentView=a.currentView),void 0!==a.selected&&(this._selected=a.selected),void 0!==a.displayFullTreePaths&&(this._displayFullTreePaths=a.displayFullTreePaths),void 0!==a.allowRename&&(this._allowRename=a.allowRename),void 0!==a.allowDelete&&(this._allowDelete=a.allowDelete),void 0!==a.directoryRequestURL&&(this._directoryRequestURL=a.directoryRequestURL),this._directoryChildrenRequestURL=void 0!==a.directoryChildrenRequestURL?a.directoryChildrenRequestURL:this._directoryRequestURL,void 0!==a.listSourceRequestURL&&(this._listSourceRequestURL=a.listSourceRequestURL),void 0!==a.listSourcesRequestURL&&(this._listSourcesRequestURL=a.listSourcesRequestURL),void 0!==a.fileUploadURL&&(this._fileUploadURL=a.fileUploadURL),void 0!==a.showDimensionsColumn&&(this._showDimensionsColumn=a.showDimensionsColumn),void 0!==a.useWebWorkers&&(this._useWebWorkers=window.Worker?a.useWebWorkers:!1),void 0!==a.sortMediaSources&&(this._sortMediaSources=a.sortMediaSources),a.debug===!0&&(this._debug=a.debug),void 0!==a.confirmBeforeDelete&&(this._confirmBeforeDelete=a.confirmBeforeDelete),a.touch===!0&&(this._touch=!0),this._webWorkersPath=void 0!==a.webWorkersPath?a.webWorkersPath:_EUREKA.src.substring(0,_EUREKA.src.lastIndexOf("/"))+"/workers/",this._useLocalStorage&&(this.getLocalStorage("currentMediaSource")&&!a.mediaSource&&(this._mediaSource=this.getLocalStorage("currentMediaSource")),this.getLocalStorage("navTreeHidden")&&!a.navTreeHidden&&(this._navTreeHidden="true"==this.getLocalStorage("navTreeHidden")?!0:!1),this.getLocalStorage("currentDirectory")&&!a.currentDirectory&&(this._currentDirectory=this.getLocalStorage("currentDirectory")),this.getLocalStorage("currentView")&&!a.currentView&&(this._currentView=this.getLocalStorage("currentView")))}return Object.defineProperty(a,"EurekaFoundIt",{get:function(){return"EurekaFoundIt"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaFileRename",{get:function(){return"EurekaFileRename"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaUnlink",{get:function(){return"EurekaUnlink"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaDirectoryCreated",{get:function(){return"EurekaDirectoryCreated"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaDirectoryOpened",{get:function(){return"EurekaDirectoryOpened"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaDirectoryClosed",{get:function(){return"EurekaDirectoryClosed"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaDirectoryChanged",{get:function(){return"EurekaDirectoryChanged"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaMediaSourceInit",{get:function(){return"EurekaMediaSourceInit"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaMediaSourceChange",{get:function(){return"EurekaMediaSourceChange"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaMediaSourcesListInit",{get:function(){return"EurekaMediaSourcesListInit"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaMediaSourcesListChange",{get:function(){return"EurekaMediaSourcesListChange"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaViewChange",{get:function(){return"EurekaViewChange"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaFilesUploaded",{get:function(){return"EurekaFilesUploaded"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaCanceled",{get:function(){return"EurekaCanceled"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"EurekaTreePainted",{get:function(){return"EurekaTreePainted"},enumerable:!0,configurable:!0}),a.prototype.getUseWebWorkers=function(){return this._useWebWorkers},a.prototype.getwebWorkersPath=function(){return this._webWorkersPath},a.prototype.getShowDimensionsColumn=function(){return this._showDimensionsColumn},a.prototype.getLocalStorage=function(a){return a=this.getStoragePrefix()+a,void 0!==localStorage.getItem(a)&&"undefined"!==localStorage.getItem(a)?localStorage.getItem(a):""},a.prototype.setLocalStorage=function(a,b){a=this.getStoragePrefix()+a,localStorage.setItem(a,b)},a.prototype.useLocalStorage=function(){return this._useLocalStorage},a.prototype.getAlertBeforeDelete=function(){return this._confirmBeforeDelete},a.prototype.getFileUploadURL=function(){return this._fileUploadURL},a.prototype.setFileUploadURL=function(a){this._fileUploadURL=a},a.prototype.setAlertBeforeDelete=function(a){this._confirmBeforeDelete=a},a.prototype.getDebug=function(){return this._debug},a.prototype.setDebug=function(a){this._debug=a},a.prototype.getHeaders=function(){return this._headers},a.prototype.getUID=function(){return this._uid},a.prototype.getStoragePrefix=function(){return this._storagePrefix},a.prototype.getSources=function(){return this._sources},a.prototype.getEditable=function(){return this._editable},a.prototype.getDisplayFullTreePaths=function(){return this._displayFullTreePaths},a.prototype.getAllowRename=function(){return this._allowRename},a.prototype.getAllowDelete=function(){return this._allowDelete},a.prototype.getHTML5UploadData=function(){return{s:this.getCurrentMediaSource(),dir:this.getCurrentDirectory()}},a.prototype.isTouch=function(){return this._touch},a.prototype.getMediaSourceDTOByID=function(a){this.getDebug()&&console.log("getMediaSourceDTOByID: "+a);for(var b=this.getSources(),c=0;c<b.length;c++){var d=b[c];if(d.getID()==a)return d}return this.getDebug()&&console.log("no media source found with id: "+a),null},a.prototype.getController=function(){return this._controller},a.prototype.setController=function(a){this._controller=a},a.prototype.getNavTreeHidden=function(){return this._navTreeHidden},a.prototype.setNavTreeHidden=function(a){this._navTreeHidden=a,this._useLocalStorage&&this.setLocalStorage("navTreeHidden",a)},a.prototype.setCurrentMediaSource=function(b,c,d,e,f){void 0===c&&(c=!0),void 0===d&&(d=!0),void 0===e&&(e=!0),void 0===f&&(f=!1);var g=this;if(this.getDebug()&&console.log("setCurrentMediaSource",b,c,d,e,f),(this._mediaSource!==b||f)&&(this._mediaSource=b,d&&void 0!==b&&this.setLocalStorage("currentMediaSource",b),c!==!1)){var h=this.getMediaSourceDTOByID(this._mediaSource);h&&(!function(){var b=document.createEvent("CustomEvent");b.initCustomEvent(a.EurekaMediaSourceChange,!0,!0,{currentDirectory:g.getCurrentDirectory(),currentMediaSource:h,clearDirectory:e}),g.getController().getView().getElement().dispatchEvent(b)}(),g._mediaSourceInit||!function(){var b=document.createEvent("CustomEvent");b.initCustomEvent(a.EurekaMediaSourceInit,!0,!0,{currentDirectory:g.getCurrentDirectory(),currentMediaSource:h}),g.getController().getView().getElement().dispatchEvent(b)}(),this._mediaSourceInit=!0)}},a.prototype.getCurrentMediaSource=function(){return this._mediaSource},a.prototype.setCurrentDirectory=function(b,c,d,e){if(void 0===c&&(c=!0),void 0===d&&(d=!0),void 0===e&&(e=!1),this.getDebug()&&console.log("setCurrentDirectory: "+b,c,d,e),void 0===d&&(d=this.useLocalStorage()),(this._currentDirectory!==b||e)&&(this._currentDirectory=b,d&&b&&this.setLocalStorage("currentDirectory",b),c!==!1)){var f=document.createEvent("CustomEvent");f.initCustomEvent(a.EurekaDirectoryChanged,!0,!0,{currentDirectory:b,currentMediaSource:this.getMediaSourceDTOByID(this._mediaSource)}),this.getController().getView().getElement().dispatchEvent(f)}},a.prototype.getCurrentDirectory=function(){return this.getDebug()&&console.log("getCurrentDirectory: "+this._currentDirectory),this._currentDirectory||"/"},a.prototype.setCurrentView=function(b,c){if(void 0===c&&(c=!0),this._currentView!==b&&(this._currentView=b,this._useLocalStorage&&this.setLocalStorage("currentView",b),c!==!1)){var d=document.createEvent("CustomEvent");d.initCustomEvent(a.EurekaViewChange,!0,!0,{currentView:b}),this.getController().getView().getElement().dispatchEvent(d)}},a.prototype.getCurrentView=function(){return this._currentView},a.prototype.getFullScreenTarget=function(){return this._fullscreenTarget},a.prototype.setLocale=function(a){this._locale=a},a.prototype.getLocale=function(){return this._locale},a.prototype.getPrependOptGroupsWithRootOption=function(){return this._prependOptGroupsWithRootOption},a.prototype.getsortMediaSources=function(){return this._sortMediaSources},a.prototype.getMediaSourcesListInit=function(){return this._mediaSourcesListInit},a.prototype.setSources=function(b,c){void 0===c&&(c=!0);var d=this;this.getDebug()&&console.log("setSources"+c),this._sources=b,c!==!1&&(!function(){var c=document.createEvent("CustomEvent");c.initCustomEvent(a.EurekaMediaSourcesListChange,!0,!0,{sources:b}),d.getController().getView().getElement().dispatchEvent(c)}(),function(){if(!d.getMediaSourcesListInit()){var c=document.createEvent("CustomEvent");c.initCustomEvent(a.EurekaMediaSourcesListInit,!0,!0,{sources:b}),d.getController().getView().getElement().dispatchEvent(c)}}())},a.prototype.sortResultsById=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b[parseInt(d.id)]=d}return b.filter(function(a){return void 0!=a})},a.prototype.setMediaSourcesData=function(a,b,c,d,e){void 0===b&&(b=!0),void 0===c&&(c=!0),void 0===d&&(d=!1),void 0===e&&(e=!1);var f=this;f.getDebug()&&console.log("setMediaSourcesData data,dispatch,setLocalStorage,clearDirectory,dispatchIdenticalValues",a,b,c,d,e);var g=a.results;f.getsortMediaSources()&&(g=f.sortResultsById(g));for(var h=[],i=f.getCurrentMediaSource(),j=!1,k=0;k<g.length;k++){var l=g[k],m=new EurekaMediaSource({id:l.id,title:l.name});h.push(m),l.id==i&&(j=!0)}this.setSources(h),f.setCurrentMediaSource(j?i:g[0].id,!0,!0,!1,!0)},a.prototype.renameFile=function(a,b){var c=document.createEvent("CustomEvent");c.initCustomEvent("EurekaFileRename",!0,!0,{fileName:a,newFilename:b,cs:this.getController().getModel().getCurrentMediaSource(),cd:this.getController().getModel().getCurrentDirectory(),path:this.getController().getModel().getCurrentDirectory()+a,newPath:this.getController().getModel().getCurrentDirectory()+b}),this.getController().getView().getElement().dispatchEvent(c)},a.prototype.deleteFile=function(a,b){var c=this,d=document.createEvent("CustomEvent");d.initCustomEvent("EurekaUnlink",!0,!0,{filename:b.getAttribute("data-filename"),timestamp:b.getAttribute("data-timestamp"),src:b.querySelector(".image img, .image .img").getAttribute("src"),dimensions:[b.getAttribute("data-dimensions-w"),b.getAttribute("data-dimensions-h")],filesize:parseInt(b.getAttribute("data-filesize-bytes"))}),c.getController().getView().getElement().dispatchEvent(d)},a.prototype.setChoosenMediaItem=function(a){function b(a){for(var b=c.getController().getView().getElement().querySelectorAll("tr.eureka__row"),d=0;d<b.length;d++){var e=b[d];if(e.getAttribute("data-filename")==a)return e}return null}var c=this,d=b(a),e=(d.querySelector(".image img, .image .img"),document.createEvent("CustomEvent"));e.initCustomEvent("EurekaFoundIt",!0,!0,{filename:a,timestamp:d.getAttribute("data-timestamp"),src:d.getAttribute("data-src"),thumb:d.getAttribute("data-thumb"),dimensions:[d.getAttribute("data-dimensions-w"),d.getAttribute("data-dimensions-h")],filesize:parseInt(d.getAttribute("data-filesize-bytes"))}),c.getController().getView().getElement().dispatchEvent(e)},a.prototype.getSelected=function(){return this._selected},a.prototype.setSelected=function(a){this._selected=a},a.prototype.getListDirectoryRequestURL=function(){return this._directoryRequestURL},a.prototype.getListDirectoryChildrenRequestURL=function(){return this._directoryChildrenRequestURL},a.prototype.setListDirectoryRequestURL=function(a){this._directoryRequestURL=a},a.prototype.getListSourceRequestURL=function(){return this._listSourceRequestURL},a.prototype.setListSourceRequestURL=function(a){this._listSourceRequestURL=a},a.prototype.getListSourcesRequestURL=function(){return this._listSourcesRequestURL},a.prototype.setListSourcesRequestURL=function(a){this._listSourcesRequestURL=a},a}(),EurekaView=function(){function a(){}return a.prototype.getController=function(){return this._controller},a.prototype.setController=function(a){this._controller=a},a.prototype.getElement=function(){return document.getElementById(this.getController().getModel().getUID())},a.prototype.assignFooterProceedListeners=function(){var a=this;a.getElement().parentNode.querySelector("footer.proceed button.cancel").addEventListener("click",function(b){b.preventDefault(),function(){var b=document.createEvent("CustomEvent");b.initCustomEvent(EurekaModel.EurekaCanceled,!0,!0,{}),a.getElement().dispatchEvent(b)}()}),a.getElement().parentNode.querySelector("footer.proceed button.cta").addEventListener("click",function(b){b.preventDefault(),a.getController().getModel().setChoosenMediaItem(a.getController().getModel().getSelected())})},a.prototype.init=function(){function a(){document.addEventListener("keydown",function(a){function b(a,b){function c(){for(var c=a.querySelectorAll("optgroup"),d=0;d<c.length;d++){var e=c[d];if(e.getAttribute("data-source")==b)return e}return null}var d=c();d&&(a.value=d.querySelector("option").value)}function c(a,b){try{var c=a.querySelectorAll("option"),d=c[b];d&&(a.value=d.getAttribute("value"))}catch(a){}}if(d.getController().getModel().getDebug()&&console.log(a),a.ctrlKey&&186===a.which){var e=document.createEvent("Event");e.initEvent("click",!0,!0),document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle").dispatchEvent(e)}if(a.altKey&&a.ctrlKey&&a.which>=48&&a.which<=57)try{var f=d.getElement().querySelectorAll(".view-btns > nav > a"),g=f[a.which-48-1];if(g){var e=document.createEvent("Event");e.initEvent("click",!0,!0),g.dispatchEvent(e)}}catch(a){}if(a.altKey&&!a.ctrlKey&&a.which>=49&&a.which<=57){var h=document.getElementById(d.getController().getModel().getUID()+"__mediasource-select");c(h,(a.which-49).toString()),b(document.getElementById(d.getController().getModel().getUID()+"__browsing").querySelector("select"),(a.which-49).toString()),d.getController().getModel().setCurrentMediaSource(h.value,!0,!0,!0,!1)}if(8===a.which&&document.activeElement){var e=document.createEvent("Event");e.initEvent("click",!0,!0);try{document.activeElement.nextSibling.querySelector("a.trash").dispatchEvent(e)}catch(a){}}if(a.altKey&&32===a.which&&document.activeElement)try{var e=document.createEvent("Event");e.initEvent("click",!0,!0),document.activeElement.nextSibling.querySelector("a.expand").dispatchEvent(e)}catch(a){}if(13===a.which&&document.activeElement)try{var e=document.createEvent("Event");e.initEvent("click",!0,!0),document.activeElement.nextSibling.querySelector("a.choose").dispatchEvent(e)}catch(a){}if(a.ctrlKey&&82===a.which)try{var e=document.createEvent("Event");e.initEvent("click",!0,!0),document.activeElement.nextSibling.querySelector("a.rename").dispatchEvent(e)}catch(a){}if(a.ctrlKey&&78===a.which)try{var e=document.createEvent("Event");e.initEvent("click",!0,!0),d.getElement().querySelector(".create-new").dispatchEvent(e)}catch(a){}if(a.ctrlKey&&85===a.which)try{var e=document.createEvent("Event");e.initEvent("click",!0,!0),document.getElementById(d.getController().getModel().getUID()+"__upload-input").dispatchEvent(e)}catch(a){}if(a.ctrlKey&&70===a.which)try{document.getElementById(d.getController().getModel().getUID()+"__filter-images").focus()}catch(a){}})}function b(){var a=document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle"),b=document.getElementById(a.getAttribute("data-toggle-target"));b.classList.remove("hidden"),document.getElementById(d.getController().getModel().getUID()).classList.add("sidebar-open"),d.getElement().querySelector(".browse-select").classList.add("tablet-p-hidden"),d.getController().getModel().setNavTreeHidden(!1);var c=document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle").getElementsByTagName("i")[0];c.classList.remove("fa-toggle-right"),c.classList.remove("icon-toggle-right"),c.classList.add("fa-toggle-left"),c.classList.add("icon-toggle-left"),a.title=a.getAttribute("data-title-close")}function c(){var a=document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle"),b=document.getElementById(a.getAttribute("data-toggle-target"));b.classList.add("hidden"),document.getElementById(d.getController().getModel().getUID()).classList.remove("sidebar-open"),d.getElement().querySelector(".browse-select").classList.remove("tablet-p-hidden"),d.getController().getModel().setNavTreeHidden(!0);var c=document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle").getElementsByTagName("i")[0];c.classList.add("fa-toggle-right"),c.classList.add("icon-toggle-right"),c.classList.remove("fa-toggle-left"),c.classList.remove("icon-toggle-left"),a.title=a.getAttribute("data-title-open")}var d=this;d._handleTreeNodeClicked=function(a){d.getController().getModel().getDebug()&&console.log("handleTreeNodeClicked"),a.preventDefault(),a.stopPropagation(),d.handleTreePathClicked(this)},d._handleTreeFolderClicked=function(a){a.preventDefault(),a.stopPropagation(),d.getController().getModel().getDebug()&&console.log("handleTreeFolderClicked");var b=this.querySelector(".fa"),c=b.classList.contains("fa-folder-open"),e=d.getClosest(this,"li"),f=this.nextSibling.getAttribute("data-cd")||"/";c?(b.classList.remove("fa-folder-open"),b.classList.remove("icon-folder-open"),b.classList.add("fa-folder","icon-folder"),e.classList.remove("open"),this.getAttribute("data-open-msg")&&(this.querySelector(".audible").innerHTML=this.getAttribute("data-open-msg"))):(b.classList.remove("fa-folder"),b.classList.remove("icon-folder"),b.classList.add("fa-folder-open"),b.classList.add("icon-folder-open"),e.classList.add("open"),this.getAttribute("data-close-msg")&&(this.querySelector(".audible").innerHTML=this.getAttribute("data-close-msg"))),function(){var a=document.createEvent("CustomEvent");a.initCustomEvent(c?EurekaModel.EurekaDirectoryClosed:EurekaModel.EurekaDirectoryOpened,!0,!0,{cd:d.getController().getModel().getCurrentDirectory(),s:d.getController().getModel().getCurrentMediaSource(),path:f}),d.getElement().dispatchEvent(a)}()},document.getElementById(d.getController().getModel().getUID()+"__pathbrowser_toggle").addEventListener("click",function(a){var d=document.getElementById(this.getAttribute("data-toggle-target"));a.preventDefault(),d.classList.contains("hidden")?b():c()}),this.assignViewButtonListeners(),this.assignFooterProceedListeners(),this.assignBrowsingSelectOptGroupListeners(),this.assignSelectListeners(),this.assignSortBtnListeners(),this.assignFilterListeners(),this.assignCreateNewDirectoryListener(),this.assignUploadListeners(),a();var e=document.createEvent("Event");e.initEvent("click",!0,!0),d.getElement().querySelector('.eureka__topbar-nav .view-btns a[data-view="'+d.getController().getModel().getCurrentView()+'"]').dispatchEvent(e),this.getController().getModel().getNavTreeHidden()===!0&&c();var f=document.getElementById(d.getController().getModel().getUID()).querySelector(".dropzone")||null;if(void 0!==html5Upload&&!d.getController().getModel().isTouch()&&html5Upload.fileApiSupported()&&f?d._html5Upload=html5Upload.initialize({uploadUrl:d.getController().getModel().getFileUploadURL(),dropContainer:f,inputField:document.getElementById(d.getController().getModel().getUID()+"__upload-input"),key:"File",data:d.getController().getModel().getHTML5UploadData(),maxSimultaneousUploads:4,onFileAdded:function(a){function b(){for(var a=f.querySelector(".progress").querySelectorAll("h2,p"),b=0;b<a.length;b++)a[b].remove()}b();var c=a.fileName.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"")+a.fileSize.toString().replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,""),e=document.createElement("div");e.classList.add("bar"),e.setAttribute("id",c),e.title=a.fileName+" is preparing for upload.";var g=document.createElement("div");g.setAttribute("style","right:100%"),e.appendChild(g);var h=document.getElementById(d.getController().getModel().getUID()).querySelector(".dropzone");h.classList.remove("complete"),h.classList.remove("error"),h.classList.add("uploading"),h.querySelector(".progress").appendChild(e),a.on({onCompleted:function(b){function c(a){try{return JSON.parse(a),!0}catch(a){}return!1}c(b)||h.classList.add("error"),e.setAttribute("title",a.fileName+" has uploaded"),h.querySelectorAll(".bar").length>=2&&e.remove(),h.querySelectorAll(".bar").length<2&&setTimeout(function(){h.querySelector(".progress").innerHTML="",h.classList.remove("uploading"),h.classList.add("complete"),function(){var a=h.querySelector(".progress"),b=document.createElement("h2"),c=document.createElement("i");c.setAttribute("class","fa fa-check-circle-o icon icon-check-circle-o"),b.appendChild(c),a.appendChild(b);var e=document.createElement("span");e.setAttribute("title","files here..."),e.innerHTML="Your files";var f=document.createElement("p");f.appendChild(e),f.innerHTML+=" have been successfully uploaded.",a.appendChild(f),h.classList.contains("error")&&(c.setAttribute("class","fa fa-times-circle icon icon-times-circle"),f.innerHTML="Oh no,<br>One or more files&nbsp;were not&nbsp;uploaded.");var g=document.createEvent("CustomEvent");g.initCustomEvent(EurekaModel.EurekaFilesUploaded,!0,!0,{}),d.getElement().dispatchEvent(g),document.getElementById(d.getController().getModel().getUID()+"__upload-form").reset()}()},640)},onProgress:function(b,c,d){b=Math.ceil(b),e.setAttribute("title",a.fileName+" is "+b+"% uploaded"),g.setAttribute("style","right:"+(100-b).toString()+"%")}})}}):f&&f.remove(),void 0===d.getController().getModel().getFileUploadURL()||""==d.getController().getModel().getFileUploadURL()){try{d.getElement().querySelector(".pathbrowser footer form").remove()}catch(a){}try{d.getElement().querySelector(".upload-form").remove()}catch(a){}try{d.getElement().querySelector(".upload-perhaps").remove()}catch(a){}}if(void 0!==d.getController().getModel().getCurrentMediaSource()&&"/"!==d.getController().getModel().getCurrentMediaSource()&&""!==d.getController().getModel().getCurrentMediaSource()&&d.recursivelyOpenTreeToCurrentDirectory(),d.getElement().addEventListener(EurekaModel.EurekaDirectoryChanged,function(a){d.getController().getModel().getDebug()&&console.log(EurekaModel.EurekaDirectoryChanged);var b=a.detail.currentDirectory,c=(d.getController().getModel().getCurrentMediaSource(),b.split("/"));c=c.filter(function(a){return void 0!==a&&""!=a});var e=document.getElementById(d.getController().getModel().getUID()+"__pathbrowser").querySelector(".level-up");c.length>=1?e.classList.remove("hidden"):e.classList.add("hidden"),function(){try{var a=d.getElement().querySelector(".pathbrowser .create-new");a.setAttribute("title","Create a new directory in "+d.sanitizeDisplayPath(b)),a.querySelector(".audible").innerHTML=a.getAttribute("title")}catch(a){}}(),function(){try{var a=d.getElement().querySelector(".pathbrowser .upload-files");a.setAttribute("title","Upload media to "+d.sanitizeDisplayPath(b)),a.querySelector(".audible").innerHTML=a.getAttribute("title");
}catch(a){}}(),d.setBrowseSelectValue(),d.setMediaSourceSelectValue();try{d._html5Upload.data=d.getController().getModel().getHTML5UploadData()}catch(a){}try{d.getElement().querySelector(".oh-no code").innerHTML=b}catch(a){}}),d.getElement().addEventListener(EurekaModel.EurekaMediaSourceChange,function(a){var b=d.getElement().querySelector(".eureka__topbar-nav .mediasource-title");if(a.detail.currentMediaSource){var c=b.getAttribute("data-prepend")||"";b.innerHTML=c+a.detail.currentMediaSource.getTitle()}d.setBrowseSelectValue(),d.setMediaSourceSelectValue();try{d._html5Upload.data=d.getController().getModel().getHTML5UploadData()}catch(a){}}),!d.getController().getModel().getShowDimensionsColumn())try{d.getElement().querySelector(".eureka-table th.dimensions").remove()}catch(a){}},a.prototype.setMediaSourceSelectValue=function(){var a=this;a.getController().getModel().getDebug()&&console.log("setMediaSourceSelectValue");var b=(a.getController().getModel().getCurrentDirectory(),a.getController().getModel().getCurrentMediaSource()),c=document.getElementById(a.getController().getModel().getUID()+"__mediasource-select");c.value!==b&&(c.value=b)},a.prototype.setBrowseSelectValue=function(){function a(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.getAttribute("data-source")==e)return c}return null}function b(a){function b(a){if(!a)return"";var b=a.split("/");return b=b.filter(function(a){return void 0!==a&&""!=a})}for(var c=a.querySelectorAll("option"),e=0;e<c.length;e++){var f=c[e],g=f.getAttribute("data-cd");if(b(g).toString()==b(d).toString())return f}}var c=this;c.getController().getModel().getDebug()&&console.log("setBrowseSelectValue");var d=c.getController().getModel().getCurrentDirectory(),e=c.getController().getModel().getCurrentMediaSource(),f=document.getElementById(c.getController().getModel().getUID()+"__browsing").querySelector("select"),g=f.querySelectorAll("optgroup"),h=a(g);if(h){var i=b(h);i&&f.value!==i.getAttribute("value")&&(f.value=i.getAttribute("value"))}},a.prototype.recursivelyOpenTreeToCurrentDirectory=function(){var a=this,b=document.getElementById(a.getController().getModel().getUID()+"__pathbrowser"),c=b.querySelectorAll("a.path");a.getController().getModel().getDebug()&&console.log("recursivelyOpenTreeToCurrentDirectory",c);for(var d=0;d<c.length;d++){var e=c[d];a.getController().getModel().getDebug()&&console.log(e.getAttribute("data-cd").split("/").filter(Boolean).toString(),a.getController().getModel().getCurrentDirectory().split("/").filter(Boolean).toString()),e.getAttribute("data-cd").split("/").filter(Boolean).toString()==a.getController().getModel().getCurrentDirectory().split("/").filter(Boolean).toString()&&!function(){function a(a){a.classList.remove("fa-folder"),a.classList.remove("icon-folder"),a.classList.add("fa-folder-open"),a.classList.add("icon-folder-open");try{a.querySelector(".audible").innerHTML=a.getAttribute("data-close-msg")}catch(a){}}e.parentNode.classList.add("active"),e.parentNode.classList.add("open");var b=getParents(e,"ul");if(b.length>1)for(var c=0;c<b.length;c++){var d=b[c].parentNode;d.classList.add("open"),a(d.querySelector(".folder > i"))}}()}},a.prototype.assignUploadListeners=function(){var a=this,b=a.getElement().querySelector(".pathbrowser .upload-files");b&&b.addEventListener("click",function(b){b.preventDefault(),b.stopPropagation(),function(){var b=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});document.getElementById(a.getController().getModel().getUID()+"__upload-input").dispatchEvent(b)}()});var c=a.getElement().querySelector(".upload-perhaps a");c&&c.addEventListener("click",function(a){a.preventDefault();var a=document.createEvent("Event");a.initEvent("click",!0,!0);try{b.dispatchEvent(a)}catch(a){}})},a.prototype.assignBrowsingSelectOptGroupListeners=function(){var a=this;a.getController().getModel().getDebug()&&console.log("assignBrowsingSelectOptGroupListeners");var b=document.getElementById(a.getController().getModel().getUID()+"__browsing").querySelector("select");b.addEventListener("change",function(b){var c=a.getSelectedOption(this),d=a.getClosest(c,"optgroup"),e=d.getAttribute("data-source");a.getController().getModel().setCurrentMediaSource(e),a.getController().getModel().setCurrentDirectory(c.getAttribute("data-cd"),!0,a.getController().getModel().useLocalStorage());var f=new AJAX;f.get(a.getController().getModel().getListSourceRequestURL(),{s:a.getController().getModel().getCurrentMediaSource()},function(a){},!0,a.getController().getModel().getXHRHeaders())})},a.prototype.assignCreateNewDirectoryListener=function(){var a=this;try{a.getElement().querySelector(".create-new").addEventListener("click",function(b){function c(b){if(13===b.keyCode){b.preventDefault(),b.stopPropagation(),this.blur(),this.setAttribute("contenteditable","false"),a.getElement().querySelector("button.create-new").focus();var c=this.innerHTML,b=document.createEvent("CustomEvent");b.initCustomEvent("EurekaDirectoryCreated",!0,!0,{newdirectory:c,cd:a.getController().getModel().getCurrentDirectory(),s:a.getController().getModel().getCurrentMediaSource(),path:a.getController().getModel().getCurrentDirectory()+c}),a.getElement().dispatchEvent(b)}}var d=document.createElement("li"),e=document.createElement("a");e.classList.add("folder"),e.innerHTML='&nbsp;<i class="fa icon fa-folder icon-folder"></i>';var f=document.createElement("a");f.classList.add("path"),f.setAttribute("title","Browse this directory"),f.setAttribute("data-cd",""),f.setAttribute("contenteditable","true"),f.innerHTML="new folder",d.appendChild(e),d.appendChild(f),d.appendChild(document.createElement("ul")),setTimeout(function(){f.focus();try{f.select()}catch(a){}},240);var g=a.getElement().querySelector(".pathbrowser .tree li.active > ul")||a.getElement().querySelector(".pathbrowser .tree > ul");g.classList.add("open"),g.parentNode.classList.add("open");try{g.previousSibling.previousSibling.querySelector(".fa").setAttribute("class","fa icon fa-folder-open icon-folder-open")}catch(a){}f.addEventListener("focus",function(a){this.addEventListener("keydown",c,!1)},!1),f.addEventListener("blur",function(a){this.removeEventListener("keydown",c,!1)},!1),g.appendChild(d)})}catch(a){}},a.prototype.assignViewButtonListeners=function(){function a(a){for(var b=document.querySelectorAll(".eureka__topbar-nav .view-btns a[data-view]:not(.view-f-btn)"),c=0;c<b.length;c++){var d=b[c];d.classList.remove("current")}a.classList.add("current")}for(var b=this,c=this.getController().getModel(),d=document.querySelectorAll(".eureka__topbar-nav .view-btns a[data-view]:not(.view-f-btn)"),e=0;e<d.length;e++){var f=d[e];f.addEventListener("click",function(b){b.preventDefault();for(var d=this,e=this.getAttribute("data-view"),f=["view-a","view-b","view-c","view-d","view-e"],g=0;g<f.length;g++){var h=f[g];document.getElementById(d.getAttribute("data-view-target")).classList.remove(h)}document.getElementById(d.getAttribute("data-view-target")).classList.add(e),a(d),c.setCurrentView(e)},!0)}var g=document.querySelector(".eureka__topbar-nav .view-btns .view-f-btn");g&&g.addEventListener("click",function(a){a.preventDefault(),b.isFullScreen()?(b.runPrefixMethod(document,"CancelFullScreen"),g.querySelector("i").classList.remove("fa-compress"),g.querySelector("i").classList.remove("icon-compress")):(b.requestFullScreen(),g.querySelector("i").classList.add("fa-compress"),g.querySelector("i").classList.add("icon-compress"))})},a.prototype.isFullScreen=function(){return this.runPrefixMethod(document,"FullScreen")||this.runPrefixMethod(document,"IsFullScreen")},a.prototype.requestFullScreen=function(){this.runPrefixMethod(document.querySelector(this.getController().getModel().getFullScreenTarget()),"RequestFullScreen")},a.prototype.runPrefixMethod=function(a,b){for(var c,d,e=["webkit","moz","ms","o",""],f=0;f<e.length&&!a[c];){if(c=b,""==e[f]&&(c=c.substr(0,1).toLowerCase()+c.substr(1)),c=e[f]+c,d=typeof a[c],"undefined"!=d)return e=[e[f]],"function"==d?a[c]():a[c];f++}},a.prototype.assignARIAKeyListeners=function(){var a=this;!function(){function b(b){for(var c=document.querySelectorAll(".eureka-table tbody > tr:not(.contextual)"),d=0;d<c.length;d++){var e=c[d];b!==e&&e.classList.contains("focused")&&e.classList.remove("focused")}b.classList.add("focused");var f=a.getProceedFooter().querySelector("button.cta");f.removeAttribute("disabled"),f.classList.remove("muted"),f.classList.add("go"),a.getController().getModel().setSelected(b.getAttribute("data-filename"))}function c(b){var c=document.getElementById("eureka_contextual__"+b.getAttribute("data-safe-filename"));c.focus();var d=a.getProceedFooter().querySelector("button.cta");d.classList.remove("go"),d.classList.add("muted")}for(var d=document.querySelectorAll(".eureka-table tbody > tr:not(.contextual)"),e=0;e<d.length;e++){var f=d[e];f.addEventListener("click",function(a){a.preventDefault(),b(this)},!1),f.addEventListener("focus",function(a){a.preventDefault(),b(this)},!1),f.addEventListener("blur",function(a){c(this)},!1)}}()},a.prototype.assignSortBtnListeners=function(){function a(a){a.preventDefault(),a.stopPropagation(),this.setAttribute("data-sort-asc",Math.abs(parseInt(this.getAttribute("data-sort-asc"))-1).toString());for(var c=this.getAttribute("data-sortby"),d="1"==this.getAttribute("data-sort-asc")?!0:!1,e=[],f=document.querySelectorAll(".eureka-table tbody > tr:not(.contextual)"),g=0;g<f.length;g++)e.push(f[g]);switch(c){case"dimensions":e.sort(function(a,b){return parseInt(a.getAttribute("data-dimensions-w"))*parseInt(a.getAttribute("data-dimensions-h"))-parseInt(b.getAttribute("data-dimensions-w"))*parseInt(b.getAttribute("data-dimensions-h"))});break;case"filesize":e.sort(function(a,b){return parseInt(a.getAttribute("data-filesize-bytes"))-parseInt(b.getAttribute("data-filesize-bytes"))});break;case"editedon":e.sort(function(a,b){return parseInt(a.getAttribute("data-timestamp"))-parseInt(b.getAttribute("data-timestamp"))});break;default:e.sort(function(a,b){return a.getAttribute("data-filename")>b.getAttribute("data-filename")?1:a.getAttribute("data-filename")<b.getAttribute("data-filename")?-1:0})}d||e.reverse();for(var h="",i=0;i<e.length;i++){var j=e[i];h+=j.outerHTML}b.getElement().querySelector(".eureka-table tbody").innerHTML=h}for(var b=this,c=b.getElement().querySelectorAll(".eureka-table th .fa-sort"),d=0;d<c.length;d++){var e=c[d];e.removeEventListener("click",a,!0),e.addEventListener("click",a,!0)}},a.prototype.assignFilterListeners=function(){function a(){for(var a=document.querySelectorAll(".eureka-table tbody > tr:not(.contextual)"),b=0;b<a.length;b++){var d=a[b];d.classList.remove("hidden")}document.getElementById(c.getController().getModel().getUID()).querySelector(".eureka-table > table > tbody").classList.remove("filtered")}function b(a){for(var b=c.getElement().querySelectorAll(".eureka-table tbody > tr:not(.contextual)"),d=0;d<b.length;d++){var e=b[d],f=!1,g=[e.getAttribute("data-filename")];e.getAttribute("data-tokens")&&(g=g.concat(e.getAttribute("data-tokens").split("||"))),function(){for(var b=0;b<g.length;b++){var c=g[b];if(a.length&&(c==a||c.indexOf(a)>-1)){f=!0;break}}}(),f?(e.classList.add("visible"),e.classList.remove("hidden")):(e.classList.add("hidden"),e.classList.remove("visible")),document.getElementById(c.getController().getModel().getUID()).querySelector(".eureka-table > table > tbody").classList.add("filtered")}}var c=this,d=document.getElementById(c.getController().getModel().getUID()+"__filter-images");d.addEventListener("input",function(c){this.value?b(this.value):a()},!1)},a.prototype.sanitizeDisplayPath=function(a){var b=a.split("/");return b=b.filter(function(a){return void 0!==a&&""!=a}),b.join("/")},a.prototype.getProceedFooter=function(){return this.getElement().parentNode.querySelector("footer.proceed")},a.prototype.handleTreePathClicked=function(a){function b(){for(var a=document.getElementById(c.getController().getModel().getUID()+"__pathbrowser"),b=a.querySelectorAll("nav.tree a.path"),d=0;d<b.length;d++){var e=b[d],f=c.getClosest(e,"li");f.classList.remove("active")}}var c=this;c.getController().getModel().getDebug()&&console.log("handleTreePathClicked: "+(a.getAttribute("data-cd")||"/")),c.getController().getModel().setCurrentDirectory(a.getAttribute("data-cd")||"/",!0,void 0);var d=c.getClosest(a,"li");b(),d.classList.add("active")},a.prototype.assignTreeListeners=function(){var a=this;a.getController().getModel().getDebug()&&console.log("assignTreeListeners");for(var b=document.getElementById(a.getController().getModel().getUID()+"__pathbrowser"),c=b.querySelectorAll("nav.tree a.path"),d=0;d<c.length;d++){var e=c[d];e.addEventListener("click",a._handleTreeNodeClicked,!1)}this.assignTreeFolderListeners()},a.prototype.assignTreeFolderListeners=function(){var a=this;a.getController().getModel().getDebug()&&console.log("assignTreeFolderListeners");for(var b=document.getElementById(a.getController().getModel().getUID()+"__pathbrowser"),c=b.querySelectorAll("nav.tree a.folder"),d=0;d<c.length;d++){var e=c[d];e.addEventListener("click",a._handleTreeFolderClicked,!1)}},a.prototype.assignSelectListeners=function(){var a=this,b=a.getElement().querySelector("#"+a.getController().getModel().getUID()+"__mediasource-select");b.addEventListener("change",function(){a.getController().getModel().setCurrentMediaSource(this.value,!0,a.getController().getModel().useLocalStorage()),a.getController().getModel().setCurrentDirectory("/",!1,a.getController().getModel().useLocalStorage());var b=new AJAX;b.get(a.getController().getModel().getListSourceRequestURL(),{s:a.getController().getModel().getCurrentMediaSource()},function(a){},!0,a.getController().getModel().getXHRHeaders())});var c=a.getElement().querySelector(".level-up");c.addEventListener("click",function(b){b.preventDefault();var c=a.getController().getModel().getCurrentDirectory(),d=c.split("/");if(d=d.filter(function(a){return void 0!==a&&""!=a}),d&&d.length){var e="/";d.length>1&&(d.pop(),e=d.join("/")),a.getController().getModel().setCurrentDirectory(e,!0,!0,!1)}})},a.prototype.emptyTree=function(){var a=this,b=document.getElementById(a.getController().getModel().getUID()+"__pathbrowser");!function(){for(var c=b.querySelectorAll("nav.tree a.path"),d=0;d<c.length;d++){var e=c[d];e.removeEventListener("click",a._handleTreeNodeClicked,!1),e.remove()}}(),function(){for(var c=b.querySelectorAll("nav.tree a.folder"),d=0;d<c.length;d++){var e=c[d];e.removeEventListener("click",a._handleTreeFolderClicked,!1),e.remove()}}()},a.prototype.assignDraggableListeners=function(){for(var a=document.querySelectorAll('*[sorta-draggable="true"]'),b=0;b<a.length;b++){var c=a[b];c.addEventListener("blur",function(a){this.parentNode.draggable=!1}),c.addEventListener("focus",function(a){this.parentNode.draggable=!1})}},a.prototype.assignChooseClickListeners=function(){function a(a){a.querySelector("div.image").addEventListener("dblclick",function(c){!function(){var c=document.createEvent("CustomEvent");c.initCustomEvent("EurekaFoundIt",!0,!0,{filename:a.getAttribute("data-filename"),timestamp:a.getAttribute("data-timestamp"),src:a.getAttribute("data-src"),thumb:a.getAttribute("data-thumb"),dimensions:[a.getAttribute("data-dimensions-w"),a.getAttribute("data-dimensions-h")],filesize:parseInt(a.getAttribute("data-filesize-bytes"))}),b.getController().getView().getElement().dispatchEvent(c)}()})}var b=this;b.getController().getModel().getDebug()&&console.log("assignChooseClickListeners");for(var c=b.getElement().querySelectorAll("tr.eureka__row"),d=0;d<c.length;d++)a(c[d])},a.prototype.paint=function(){this.assignARIAKeyListeners(),this.assignContextualClickListeners(),this.assignDraggableListeners(),this.assignChooseClickListeners(),this.assignSortBtnListeners()},a.prototype.createTreeNode=function(a){var b=this;a=a.split("/").filter(Boolean).join("/")+"/";var c=document.createElement("li"),d=document.createElement("a");d.innerHTML="&nbsp;",d.setAttribute("href","javascript:;"),d.classList.add("folder"),d.setAttribute("data-open-msg","Expand "+a+" "),d.setAttribute("data-close-msg","Collapse "+a+" ");var e=document.createElement("i");e.classList.add("fa"),e.classList.add("icon"),e.classList.add("fa-folder"),e.classList.add("icon-folder"),d.appendChild(e),function(){var a=document.createElement("span");a.classList.add("audible"),a.innerHTML=d.getAttribute("data-open-msg"),d.appendChild(a)}();var f=document.createElement("a");f.classList.add("path"),f.setAttribute("href","javascript:;"),f.setAttribute("title","Browse "+a);var g=a.split("/");g=g.filter(function(a){return void 0!==a&&""!=a});var h=g.join("/");b.getController().getModel().getDisplayFullTreePaths()?"/"==h[h.length-1]&&(h=h.substring(0,h.length-1)):h=g[g.length-1],f.setAttribute("data-cd",a),f.innerHTML=" "+h,c.appendChild(d),c.appendChild(f);var i=document.createElement("ul");return c.appendChild(i),c},a.prototype.paintTree=function(a){function b(a,d){for(var e=0;e<a.length;e++){var f=a[e],g=c.createTreeNode(f.path),h=g.querySelector("ul");void 0!==f.children&&f.children.length&&b(f.children,h),d.appendChild(g)}}var c=this;c.getController().getModel().getDebug()&&console.log("paintTree",a);var d=c.getElement().querySelector("nav.tree"),e=a.results;d.innerHTML="";var f=document.createElement("ul");d.appendChild(f),b(e,f),c.assignTreeListeners(),c.recursivelyOpenTreeToCurrentDirectory();var g=document.createEvent("CustomEvent");g.initCustomEvent(EurekaModel.EurekaTreePainted,!0,!0,{data:a}),c.getElement().dispatchEvent(g)},a.prototype.paintJSON=function(a){function b(a,b,c){a.addEventListener("error",function(){var a=b.filename.split("."),d="file-o";switch(a[a.length-1].toLowerCase()){case"css":d="css3";break;case"csv":d="file-excel-o";break;case"xls":d="file-excel-o";break;case"numbers":d="file-excel-o";break;case"css":d="file-excel-o";break;case"mp3":d="file-sound-o";break;case"wav":d="file-sound-o";break;case"wma":d="file-sound-o";break;case"aac":d="file-sound-o";break;case"flac":d="file-sound-o";break;case"ppt":d="file-powerpoint-o";break;case"pot":d="file-powerpoint-o";break;case"pps":d="file-powerpoint-o";break;case"zip":d="file-zip-o";break;case"gzip":d="file-zip-o";break;case"tar":d="file-zip-o";break;case"mp4":d="file-movie-o";break;case"ogv":d="file-movie-o";break;case"m4v":d="file-movie-o";break;case"avi":d="file-movie-o";break;case"jpg":case"jpeg":case"gif":case"tiff":case"png":case"bpg":case"img":case"webp":d="file-picture-o";break;case"php":case"html":case"htm":case"md":d="file-code-o";break;case"js":d="file-text-o";break;default:d="file-o"}var e=function(){var a=document.createElement("div");a.classList.add("icon-wrapper"),a.classList.add("img");var b=document.createElement("i");return b.classList.add("fa"),b.classList.add("icon"),b.classList.add("fa-"+d),b.classList.add("icon-"+d),a.appendChild(b),a}();try{document.getElementById(c+"__thumb").outerHTML=e.outerHTML}catch(a){}})}function c(a){var b=document.createElement("code");return b.innerHTML=a,b}function d(){function a(){function a(){var a=document.createElement("a");a.classList.add("expand"),a.setAttribute("href",p),a.setAttribute("title","Expand "+n),a.setAttribute("target","_blank"),a.setAttribute("tabindex","0");var b=document.createElement("i");return b.classList.add("fa"),b.classList.add("icon"),b.classList.add("fa-expand"),b.classList.add("icon-expand"),a.appendChild(b),a.innerHTML+=" Expand",a}function b(){var a=document.createElement("a");a.classList.add("choose"),a.setAttribute("title","Choose "+n),a.setAttribute("target","_blank"),a.setAttribute("tabindex","0");var b=document.createElement("i");return b.classList.add("fa"),b.classList.add("icon"),b.classList.add("fa-check-circle-o"),b.classList.add("icon-check-circle-o"),a.appendChild(b),a.innerHTML+=" Choose",a}function c(){var a=document.createElement("a");a.classList.add("rename"),a.setAttribute("title","Rename "+n),a.setAttribute("target","_blank"),a.setAttribute("tabindex","0");var b=document.createElement("i");return b.classList.add("fa"),b.classList.add("icon"),b.classList.add("fa-edit"),b.classList.add("icon-edit"),a.appendChild(b),a.innerHTML+=" Rename",a}function d(){var a=document.createElement("a");a.classList.add("dangerous"),a.classList.add("trash"),a.setAttribute("title","Delete "+n),a.setAttribute("target","_blank"),a.setAttribute("tabindex","0");var b=document.createElement("i");return b.classList.add("fa"),b.classList.add("icon"),b.classList.add("fa-trash"),b.classList.add("icon-trash"),a.appendChild(b),a.innerHTML+=" Delete",a}var f=document.createElement("nav");return f.classList.add("flexible_row"),f.classList.add("contextual__nav"),f.appendChild(a()),f.appendChild(b()),e.getController().getModel().getAllowRename()&&document.execCommand&&f.appendChild(c()),e.getController().getModel().getAllowDelete()&&f.appendChild(d()),f}var b=document.createElement("tr");b.classList.add("contextual"),b.setAttribute("id","eureka_contextual__"+o);var c=document.createElement("td");return c.setAttribute("colspan","4"),c.appendChild(a()),b.appendChild(c),b}var e=this;e.getController().getModel().getDebug()&&console.log("paintJSON",a);var f=this.getController().getModel(),g="/"==a.cd.charAt(a.cd.length-1)?a.cd:a.cd+"/",h=a.results,i="",j=[],k=!1;e.getElement().classList.remove("nothing-found");for(var l=0;l<h.length;l++){var m=h[l];if(m.filename){var n=m.filename,o=n.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,""),p=m.src,q=m.thumb,r=m.filesize,s=m.dimensions,t=parseInt(m.editedon)>0?parseInt(m.editedon):null,u=document.createElement("tr");u.classList.add("eureka__row"),u.setAttribute("tabindex","0"),u.setAttribute("data-tokens",""),u.setAttribute("data-filename",n),u.setAttribute("data-safe-filename",o),u.setAttribute("data-src",p),q&&u.setAttribute("data-thumb",q),u.setAttribute("data-dimensions-w",s.split("x")[0]),u.setAttribute("data-dimensions-h",s.split("x")[1]),u.setAttribute("data-filesize-bytes",r),u.setAttribute("data-timestamp",t?t.toString():"0");var v=document.createElement("td");v.setAttribute("contenteditable","false"),v.classList.add("eureka__row-image");var w=document.createElement("div");w.classList.add("image");var x=document.createElement("img");x.setAttribute("id",o+"__thumb"),b(x,m,o),w.appendChild(x),x.setAttribute("src",q?q:p);var y=document.createElement("code");y.setAttribute("contenteditable","true"),y.setAttribute("tabindex","-1"),y.setAttribute("sorta-draggable","true"),y.innerHTML=n,v.appendChild(w),v.appendChild(y);var z=document.createElement("td");z.classList.add("eureka__row-dimensions"),z.appendChild(c(s||"n/a"));var A=document.createElement("td");A.classList.add("eureka__row-filesize"),parseInt(r)?A.appendChild(c(e.formatFileSize(r))):A.appendChild(c("n/a"));var B=document.createElement("td");B.classList.add("eureka__row-editedon"),t?B.appendChild(c(new Date(1e3*t).toLocaleDateString(f.getLocale(),{month:"short",day:"numeric",year:"numeric"}))):B.appendChild(c("n/a")),u.appendChild(v),e.getController().getModel().getShowDimensionsColumn()&&u.appendChild(z),u.appendChild(A),u.appendChild(B),i+=u.outerHTML,i+=d().outerHTML,k=!0}else j.push({cd:g,directory:m.directory})}k||e.getElement().classList.add("nothing-found"),function(){for(var a=0;a<j.length;a++){var b=j[a];e.asyncronouslyAddDirectory(b.cd,b.directory)}j.length&&e.assignTreeListeners()}();var C=document.querySelector("#"+this.getController().getModel().getUID()+" .eureka-table > table > thead");document.querySelector("#"+this.getController().getModel().getUID()+" .eureka-table").innerHTML="<table>"+C.outerHTML+"<tbody>"+i+"</tbody></table>";try{this.getElement().querySelector("nav.tree li.active").classList.remove("active")}catch(a){}try{!function(){var b=e.getElement().querySelector('nav.tree li > a[data-cd="'+a.cd+'"]').parentNode;b.classList.add("active"),b.classList.add("open");var c=b.querySelector(".folder .fa-folder");c.classList.add("fa-folder-open"),c.classList.add("icon-folder-open"),c.classList.remove("fa-folder")}()}catch(a){}try{this.getElement().querySelector(".pathbrowser__topbar > select").value=a.cs}catch(a){}this.paint()},a.prototype.asyncronouslyAddDirectory=function(a,b){var c=this;c.getController().getModel().getDebug()&&console.log("asyncronouslyAddDirectory");for(var d=document.getElementById(c.getController().getModel().getUID()+"__pathbrowser"),e=d.querySelectorAll(".tree .path"),f=a.split("/").filter(Boolean),g=a+b+"/",h=g.split("/").filter(Boolean),i=0;i<e.length;i++){var j=e[i];if(j.getAttribute("data-cd").split("/").filter(Boolean).equals(h))return void(c.getController().getModel().getDebug()&&console.log(g+" alread exists"))}for(var i=0;i<e.length;i++){var j=e[i],k=j.getAttribute("data-cd");f.equals(k.split("/").filter(Boolean))&&!function(a){for(var d=a.nextSibling,e=d.querySelectorAll(":scope > li > .path"),f=!1,h=0;h<e.length;h++){var i=e[h],j=function(a){var b=a.getAttribute("data-cd").split("/").filter(Boolean);return b[b.length-1]}(i),k=[b,j];if(k.sort(),k[0]==b){d.insertBefore(c.createTreeNode(g),i.parentNode),f=!0;break}}f||(d.appendChild(c.createTreeNode(g)),f=!0)}(j)}!function(){var a=document.getElementById(c.getController().getModel().getUID()+"__browsing"),b=c.getController().getModel().getCurrentMediaSource(),d=function(){for(var c=a.querySelectorAll("optgroup"),d=0;d<c.length;d++){var e=c[d];if(e.getAttribute("data-source")==b)return e}return null}();if(d){for(var e=g.split("/").filter(Boolean).join("/"),f=d.querySelectorAll("option"),h=0;h<f.length;h++){var i=f[h];if(i.innerHTML==e)return}var j=document.createElement("option");j.setAttribute("value",JSON.stringify({cs:c.getController().getModel().getCurrentMediaSource(),cd:e})),j.setAttribute("data-cd",e+"/"),j.innerHTML=e;for(var k=!1,h=0;h<f.length;h++){var i=f[h],l=[i.innerHTML,e];if(l.sort(),e==l[0]){d.insertBefore(j,i),k=!0;break}}k||d.appendChild(j)}}(),function(){var a=document.createEvent("CustomEvent"),b=c.getTreeData();a.initCustomEvent(EurekaModel.EurekaTreePainted,!0,!0,{data:b}),c.getElement().dispatchEvent(a)}()},a.prototype.getTreeData=function(){function a(b,c){for(var d=0;d<c.length;d++){var e=c[d],f={path:e.querySelector(":scope > a.path").getAttribute("data-cd"),children:new Array};a(f,e.querySelectorAll(":scope > ul > li")),b.children.push(f)}}var b=this;b.getController().getModel().getDebug()&&console.log("getTreeData");for(var c={cs:parseInt(b.getController().getModel().getCurrentMediaSource()),title:b.getController().getModel().getMediaSourceDTOByID(b.getController().getModel().getCurrentMediaSource()).getTitle(),results:new Array},d=document.getElementById(b.getController().getModel().getUID()+"__pathbrowser"),e=d.querySelector("nav.tree"),f=e.querySelectorAll(":scope > ul > li"),g=0;g<f.length;g++){var h=f[g],i={path:h.querySelector(":scope > a.path").getAttribute("data-cd"),children:new Array};a(i,h.querySelectorAll(":scope > ul > li")),c.results.push(i)}return c},a.prototype.assignContextualClickListeners=function(){function a(){function a(a){var b=d.getClosest(a,"tr"),c=b.previousSibling;d.getController().getModel().setChoosenMediaItem(c.getAttribute("data-filename"))}for(var b=d.getElement().querySelectorAll("tr.contextual a.choose"),c=0;c<b.length;c++){var e=b[c];e.addEventListener("click",function(b){b.preventDefault(),a(this)},!1),e.addEventListener("focus",function(a){d.getElement().parentNode.querySelector("footer.proceed .cta").classList.add("go"),d.getElement().parentNode.querySelector("footer.proceed .cta").disabled=!1,d.getElement().parentNode.querySelector("footer.proceed .cta").removeAttribute("disabled")},!1),e.addEventListener("blur",function(a){d.getElement().parentNode.querySelector("footer.proceed .cta").classList.remove("go")},!1)}}function b(){function a(a){function b(a){try{a.remove()}catch(b){a.parentNode.removeChild(a)}}var c=d.getClosest(a,"tr"),e=c.previousSibling,f=c.nextSibling;if(d.getController().getModel().getAlertBeforeDelete()&&!window.confirm("Are you sure you want to delete "+e.getAttribute("data-filename")+"?"))return!1;d.getController().getModel().deleteFile(e.getAttribute("data-filename"),e),b(e),b(c);try{f.focus()}catch(a){}}function b(b){13===b.keyCode&&a(this)}for(var c=document.querySelectorAll("tr.contextual a.trash"),e=0;e<c.length;e++){var f=c[e];f.addEventListener("click",function(b){a(this)},!1),f.addEventListener("focus",function(a){this.addEventListener("keydown",b,!1)},!1),f.removeEventListener("blur",function(a){this.removeEventListener("keydown",b,!1)},!1)}}function c(){function a(a){var e=c(this);d.getClosest(this,".contextual").previousSibling;13===a.keyCode&&(a.preventDefault(),a.stopPropagation(),b(e))}function b(a){a.focus();try{a.select()}catch(a){}}function c(a){var b=d.getClosest(a,"tr"),c=b.previousSibling,e=c.querySelector('.eureka__row-image code[contenteditable="true"]');return e}for(var e=document.querySelectorAll("tr.contextual a.rename"),f=0;f<e.length;f++){var g=e[f];g.addEventListener("click",function(a){a.preventDefault();var d=c(this);b(d)},!1),g.addEventListener("focus",function(b){this.addEventListener("keydown",a,!1)},!1),g.addEventListener("blur",function(b){this.removeEventListener("keydown",a,!1)},!1)}}var d=this;d.assignContexualCodeFocusListeners(),a(),c(),b()},a.prototype.assignContexualCodeFocusListeners=function(){function a(a){if(13===a.keyCode){a.preventDefault();var c=this.parentNode.parentNode,d=c.nextSibling,f=c.getAttribute("data-filename");e.contentEditable="false";var g=this.innerHTML;b.getController().getModel().renameFile(f,g);var h=d.querySelector("nav > a.rename");return h.focus(),window.getSelection().collapse(h,0),!1}return!0}for(var b=this,c=this.getElement().querySelectorAll('tr.eureka__row .eureka__row-image code[contenteditable="true"]'),d=0;d<c.length;d++){var e=c[d];e.addEventListener("focus",function(){this.addEventListener("keydown",a,!1)},!1)}},a.prototype.sortBrowseSelectOptGroupsByMediaSourceId=function(a){void 0===a&&(a=document.getElementById(this.getController().getModel().getUID()+"__browsing").querySelector("select"));for(var b=[],c=a.querySelectorAll("optgroup"),d=0;d<c.length;d++)b.push(c[d]);var e=b.sort(function(a,b){return parseInt(a.getAttribute("data-source"))-parseInt(b.getAttribute("data-source"))});a.innerHTML="";for(var f=0;f<e.length;f++){var g=e[f];a.appendChild(g)}},a.prototype.updateMediaSourceListings=function(a){function b(){d.getController().getModel().getDebug()&&console.log("updateTreeSelect");var b=document.getElementById(d.getController().getModel().getUID()+"__mediasource-select"),c=null;try{c=b.querySelector('option[value="'+e+'"]')}catch(a){}c||(c=document.createElement("option"),c.setAttribute("value",e),c.innerHTML=a.title,b.appendChild(c))}function c(){function b(c){for(var e=0;e<c.length;e++){var f=c[e],g=document.createElement("option");g.innerHTML=d.sanitizeDisplayPath(f.path)?d.sanitizeDisplayPath(f.path):f.path,g.setAttribute("value",JSON.stringify({cs:a.cs,cd:d.sanitizeDisplayPath(f.path)})),g.setAttribute("data-cd",f.path),h.push(g),f.children&&f.children.length&&b(f.children)}}d.getController().getModel().getDebug()&&console.log("updateTopBarSelect");var c=document.getElementById(d.getController().getModel().getUID()+"__browsing").querySelector("select");d.getController().getModel().getDebug()&&console.log(c);var f=null;try{f=c.querySelector('optgroup[data-source="'+e+'"]')}catch(a){}f||(f=document.createElement("optgroup"),f.setAttribute("label",a.title),f.setAttribute("data-source",e));var g=a.results;d.getController().getModel().getPrependOptGroupsWithRootOption()&&g.unshift({path:"/"});var h=[];b(g),f.innerHTML="";for(var i=0;i<h.length;i++){var j=h[i];f.appendChild(j)}c.appendChild(f),d.sortBrowseSelectOptGroupsByMediaSourceId(c)}var d=this;d.getController().getModel().getDebug()&&console.log("updateMediaSourceListings: ",a);var e=a.cs;this.getController().getModel().getMediaSourceDTOByID(e);b(),c(),d.setBrowseSelectValue(),d.setMediaSourceSelectValue()},a.prototype.getSelectedOption=function(a){
for(var b=a.querySelectorAll("option"),c=0;c<b.length;c++){var d=b[c];if(d.selected)return d}},a.prototype.formatFileSize=function(a){for(var b=[" Bytes"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],c=1;c<b.length;c++)if(a<Math.pow(1024,c))return Math.round(a/Math.pow(1024,c-1)*100)/100+b[c-1];return a.toString()},a.prototype.getClosest=function(a,b){for(var c=b.charAt(0);a&&a!==document;a=a.parentNode){if("."===c&&a.classList.contains(b.substr(1)))return a;if("#"===c&&a.id===b.substr(1))return a;if("["===c&&a.hasAttribute(b.substr(1,b.length-2)))return a;if(a.tagName.toLowerCase()===b)return a}return null},a}(),EurekaController=function(){function a(a){this.opts=a,this._model=a.model,this._view=a.view}return a.prototype.getModel=function(){return this._model},a.prototype.getView=function(){return this._view},a.prototype.init=function(){var a=this,b=a.getView().getElement();a.getModel().getDebug()&&console.log("init"),a.getView().getElement().addEventListener(EurekaModel.EurekaTreePainted,function(b){var c=b.detail.data;a.getModel().getDebug()&&console.log("EurekaTreePainted!!!",b,c),a.getModel().useLocalStorage()&&a.getModel().setLocalStorage(c.cs.toString()+"_mediaSourceData",JSON.stringify(c))}),a.getModel().useLocalStorage()&&(!function(){var b=a.getModel().getLocalStorage("mediaSourcesData");a.getModel().getDebug()&&console.log("using local storage setMediaSourcesData","mediaSourcesData: ",b),b&&a.getModel().setMediaSourcesData(JSON.parse(b),!0,!1,!1,!0)}(),function(){var b=a.getModel().getLocalStorage(a.getModel().getCurrentMediaSource()+"_mediaSourceData");b&&(a.getModel().getDebug()&&console.log("using local storage paintTree","mediaSourceData: ",b),a.getView().paintTree(JSON.parse(b)),a.getView().recursivelyOpenTreeToCurrentDirectory())}(),function(){var b=a.getModel().getLocalStorage("lastDirectoryPainted");if(a.getModel().getDebug()&&console.log("using local storage paintJSON","directoryData: ",b),b){var c=JSON.parse(b);a.getModel().setCurrentDirectory(c.cd,!1,!1,!1),a.getView().paintJSON(c),a.getView().recursivelyOpenTreeToCurrentDirectory()}}()),b.addEventListener(EurekaModel.EurekaViewChange,function(a){}),b.addEventListener(EurekaModel.EurekaDirectoryChanged,function(b){function c(b){a.getModel().useLocalStorage()&&a.getModel().setLocalStorage("lastDirectoryPainted",JSON.stringify(b)),a.getModel().getDebug()&&console.log(b),a.getView().paintJSON(b)}if(a.getModel().getCurrentMediaSource())if(a.getModel().getDebug()&&console.log(EurekaModel.EurekaDirectoryChanged," requesting data from ",a.getModel().getListDirectoryRequestURL()),a.getModel().getUseWebWorkers())!function(){var d=new Worker(a.getModel().getwebWorkersPath()+"listdirectory.js");d.addEventListener("message",function(a){c(a.data)},!1),d.postMessage({listDirectoryRequestURL:a.getModel().getListDirectoryRequestURL(),currentMediaSource:a.getModel().getCurrentMediaSource(),currentDirectory:b.detail.currentDirectory||"/",headers:a.getModel().getXHRHeaders()})}();else{var d=new AJAX;d.get(a.getModel().getListDirectoryRequestURL(),{s:a.getModel().getCurrentMediaSource(),dir:b.detail.currentDirectory||"/"},function(a){c(JSON.parse(a))},!0,a.getModel().getXHRHeaders())}}),b.addEventListener(EurekaModel.EurekaDirectoryOpened,function(b){function c(b){a.getModel().getDebug()&&console.log(b);for(var c=b.results,e=0;e<c.length;e++){var f=c[e];f.directory&&a.getView().asyncronouslyAddDirectory(d,f.directory)}c.length&&a.getView().assignTreeListeners()}a.getModel().getDebug()&&console.log(EurekaModel.EurekaDirectoryOpened);var d="/"==b.detail.path.charAt(b.detail.path.length-1)?b.detail.path:b.detail.path+"/";if(a.getModel().getUseWebWorkers())!function(){var d=new Worker(a.getModel().getwebWorkersPath()+"listdirectory.js");d.addEventListener("message",function(a){c(a.data)},!1),d.postMessage({listDirectoryRequestURL:a.getModel().getListDirectoryChildrenRequestURL(),currentMediaSource:a.getModel().getCurrentMediaSource(),currentDirectory:b.detail.path||"/",headers:a.getModel().getXHRHeaders()})}();else{var e=new AJAX;e.get(a.getModel().getListDirectoryChildrenRequestURL(),{s:a.getModel().getCurrentMediaSource(),dir:b.detail.path||"/"},function(a){c(JSON.parse(a))},!0,a.getModel().getXHRHeaders())}}),b.addEventListener(EurekaModel.EurekaMediaSourceChange,function(b){function c(c){a.getModel().getDebug()&&console.log("EurekaMediaSourceChange handleJSONData: ",c,b),c.cs&&a.getModel().useLocalStorage()&&a.getModel().setLocalStorage(c.cs+"_mediaSourceData",JSON.stringify(c)),a.getView().paintTree(c),1==b.detail.clearDirectory&&(a.getModel().getDebug()&&console.log("clearing directory"),a.getModel().setCurrentDirectory("",!0,!1))}if(a.getModel().getDebug()&&console.log(EurekaModel.EurekaMediaSourceChange),a.getModel().getUseWebWorkers())!function(){var b=new Worker(a.getModel().getwebWorkersPath()+"listsource.js");b.addEventListener("message",function(a){c(a.data)},!1),b.postMessage({listSourceRequestURL:a.getModel().getListSourceRequestURL(),currentMediaSource:a.getModel().getCurrentMediaSource(),headers:a.getModel().getXHRHeaders()})}();else{var d=new AJAX;d.get(a.getModel().getListSourceRequestURL(),{s:b.detail.currentMediaSource},function(a){c(JSON.parse(a))},!0,a.getModel().getXHRHeaders())}}),b.addEventListener(EurekaModel.EurekaMediaSourceInit,function(b){a.getModel().getDebug()&&console.log("EurekaMediaSourceInit: !!!!",b),a.getModel().useLocalStorage()||a.getModel().setCurrentDirectory(a.getModel().getCurrentDirectory(),!0,!1,!0)}),b.addEventListener(EurekaModel.EurekaMediaSourcesListChange,function(b){function c(b){function c(b){a.getModel().getDebug()&&console.log(b),a.getView().updateMediaSourceListings(b)}a.getModel().getDebug()&&console.log("requestMediaListings");var d=b.getID();if(a.getModel().getUseWebWorkers())!function(){var b=new Worker(a.getModel().getwebWorkersPath()+"listsource.js");b.addEventListener("message",function(a){c(a.data)},!1),b.postMessage({listSourceRequestURL:a.getModel().getListSourceRequestURL(),currentMediaSource:d,headers:a.getModel().getXHRHeaders()})}();else{var e=new AJAX;e.get(a.getModel().getListSourceRequestURL(),{s:d},function(a){a=JSON.parse(a),c(a)},!0,a.getModel().getXHRHeaders())}}a.getModel().getDebug()&&console.log("MediaSourcesListChange: ");for(var d=b.detail.sources,e=0;e<d.length;e++){var f=new EurekaMediaSource(d[e].opts);f.getID();c(f)}}),a.getModel().getDebug()&&console.log("MediaSourcesListChange listener added"),function(){function b(b){a.getModel().getDebug()&&console.log(b),a.getModel().useLocalStorage()&&a.getModel().setLocalStorage("mediaSourcesData",JSON.stringify(b)),a.getModel().setMediaSourcesData(b)}if(a.getModel().getDebug()&&console.log("requesting sources: "),a.getModel().getUseWebWorkers())!function(){var c=new Worker(a.getModel().getwebWorkersPath()+"listsources.js");c.addEventListener("message",function(a){b(a.data)},!1),c.postMessage({listSourcesRequestURL:a.getModel().getListSourcesRequestURL(),headers:a.getModel().getXHRHeaders()})}();else{var c=new AJAX;c.get(a.getModel().getListSourcesRequestURL(),{},function(a){a=JSON.parse(a),b(a)},!0,a.getModel().getXHRHeaders())}}()},a}();