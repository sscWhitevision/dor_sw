Redactor.add("plugin","alignment",{translations:{en:{align:"Align","align-left":"Align Left","align-center":"Align Center","align-right":"Align Right","align-justify":"Align Justify"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.block=t.block,this.toolbar=t.toolbar},start:function(){var t={};t.left={title:this.lang.get("align-left"),api:"plugin.alignment.set",args:"left"},t.center={title:this.lang.get("align-center"),api:"plugin.alignment.set",args:"center"},t.right={title:this.lang.get("align-right"),api:"plugin.alignment.set",args:"right"},t.justify={title:this.lang.get("align-justify"),api:"plugin.alignment.set",args:"justify"};var e=this.toolbar.addButton("alignment",{title:this.lang.get("align")});e.setIcon('<i class="re-icon-alignment"></i>'),e.setDropdown(t)},set:function(t){if("left"===t&&"ltr"===this.opts.direction)return this._remove();var e={style:{"text-align":t}};this.block.toggle(e)},_remove:function(){this.block.remove({style:"text-align"})}}),function(e){e.add("plugin","beyondgrammar",{init:function(t){this.app=t,this.opts=t.opts,this.editor=t.editor,this.cleaner=t.cleaner},onoriginalblur:function(t){if(e.dom(t.target).hasClass("pwa-suggest"))return t.preventDefault(),void(this.app.stopBlur=!0);this.app.stopBlur=!1},onsource:{closed:function(){this.editor.focus(),this._activate()}},start:function(){this.GrammarChecker=this._getGrammarChecker(),this.opts.beyondgrammar&&this.GrammarChecker&&(this.cleaner.addUnconvertRules("spellcheck",function(t){t.find(".pwa-mark").unwrap()}),this._activate())},_activate:function(){var t=this.editor.getElement();t.attr("spellcheck",!1);var e=new this.GrammarChecker(t.get(),this.opts.beyondgrammar.service,this.opts.beyondgrammar.grammar);e.init().then(function(){e.activate()})},_getGrammarChecker:function(){return void 0!==window.BeyondGrammar&&window.BeyondGrammar.GrammarChecker}})}(Redactor),function(o){o.add("plugin","clips",{translations:{en:{clips:"Clips","clips-select":"Please, select a clip"}},modals:{clips:""},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.toolbar=t.toolbar,this.insertion=t.insertion},onmodal:{clips:{open:function(t){this._build(t)}}},start:function(){if(this.opts.clips){var t={title:this.lang.get("clips"),api:"plugin.clips.open"};this.toolbar.addButton("clips",t).setIcon('<i class="re-icon-clips"></i>')}},open:function(t){var e={title:this.lang.get("clips"),width:"600px",name:"clips"};this.app.api("module.modal.build",e)},_build:function(t){var e=t.getBody(),i=this._buildLabel(),s=this._buildList();this._buildItems(s),e.html(""),e.append(i),e.append(s)},_buildLabel:function(){var t=o.dom("<label>");return t.html(this.lang.parse("## clips-select ##:")),t},_buildList:function(){var t=o.dom("<ul>");return t.addClass("redactor-clips-list"),t},_buildItems:function(t){for(var e=this.opts.clips,i=0;i<e.length;i++){var s=o.dom("<li>"),n=o.dom("<span>");n.attr("data-index",i),n.html(e[i][0]),n.on("click",this._insert.bind(this)),s.append(n),t.append(s)}},_insert:function(t){var e=o.dom(t.target).attr("data-index"),i=this.opts.clips[e][1];this.app.api("module.modal.close"),this.insertion.insertRaw(i)}})}(Redactor),Redactor.add("plugin","counter",{translations:{en:{words:"words",chars:"chars"}},init:function(t){this.app=t,this.lang=t.lang,this.utils=t.utils,this.editor=t.editor,this.statusbar=t.statusbar},start:function(){this.editor.getElement().on("keyup.redactor-plugin-counter",this.count.bind(this)),this.count()},stop:function(){this.editor.getElement().off(".redactor-plugin-counter"),this.statusbar.remove("words"),this.statusbar.remove("chars")},count:function(){var t=0,e=0,i=0,s=this.editor.getElement().html();if(""!==(s=this._clean(s))){var n=s.split(/\s+/),o=s.match(/\s/g);t=n?n.length:0,i=o?o.length:0,e=s.length}var a={words:t,characters:e,spaces:i};this.app.broadcast("counter",a),this.statusbar.add("words",this.lang.get("words")+": "+a.words),this.statusbar.add("chars",this.lang.get("chars")+": "+a.characters)},_clean:function(t){return t=(t=(t=(t=(t=(t=(t=t.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),t=this.utils.removeInvisibleChars(t)}}),function(a){a.add("plugin","definedlinks",{init:function(t){this.app=t,this.opts=t.opts,this.component=t.component,this.links=[]},onmodal:{link:{open:function(t,e){this.opts.definedlinks&&(this.$modal=t,this.$form=e,this._load())}}},_load:function(){"object"==typeof this.opts.definedlinks?this._build(this.opts.definedlinks):a.ajax.get({url:this.opts.definedlinks,success:this._build.bind(this)})},_build:function(t){if(0===(s=this.$modal.find("#redactor-defined-links")).length){var e=this.$modal.getBody(),i=a.dom('<div class="form-item" />'),s=a.dom('<select id="redactor-defined-links" />');i.append(s),e.prepend(i)}for(var n in this.links=[],s.html(""),s.off("change"),t)if(t.hasOwnProperty(n)&&"object"==typeof t[n]){this.links[n]=t[n];var o=a.dom("<option>");o.val(n),o.html(t[n].name),s.append(o)}s.on("change",this._select.bind(this))},_select:function(t){var e=this.$form.getData(),i=a.dom(t.target).val(),s={text:"",url:""};"0"!==i&&(s.text=this.links[i].name,s.url=this.links[i].url),""!==e.text&&(s={url:s.url}),this.$form.setData(s)}})}(Redactor),function(l){l.add("plugin","filemanager",{translations:{en:{choose:"Choose"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts},onmodal:{file:{open:function(t,e){this.opts.fileManagerJson&&this._load(t)}}},_load:function(t){var e=t.getBody();this.$box=l.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),e.append(this.$box),l.ajax.get({url:this.opts.fileManagerJson,success:this._parse.bind(this)})},_parse:function(t){var e=l.dom('<ul id="redactor-filemanager-list">');for(var i in t){var s=t[i];if("object"==typeof s){var n=l.dom("<li>"),o=l.dom("<a>");o.attr("href","#"),o.addClass("redactor-file-manager-link"),o.attr("data-params",encodeURI(JSON.stringify(s))),o.text(s.title||s.name),o.on("click",this._insert.bind(this));var a=l.dom("<span>");a.addClass("r-file-name"),a.text(s.name),o.append(a);var r=l.dom("<span>");r.addClass("r-file-size"),r.text("("+s.size+")"),o.append(r),n.append(o),e.append(n)}}this.$box.append(e)},_insert:function(t){t.preventDefault();var e=l.dom(t.target).closest(".redactor-file-manager-link"),i=JSON.parse(decodeURI(e.attr("data-params")));this.app.api("module.file.insert",{file:i})}})}(Redactor),function(c){c.add("plugin","fontcolor",{translations:{en:{fontcolor:"Text Color",text:"Text",highlight:"Highlight"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.inline=t.inline,this.toolbar=t.toolbar,this.selection=t.selection,this.colors=this.opts.fontcolors?this.opts.fontcolors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"]},onfontcolor:{set:function(t,e){this._set(t,e)},remove:function(t){this._remove(t)}},start:function(){var t={title:this.lang.get("fontcolor")},e=this._buildDropdown();this.$button=this.toolbar.addButton("fontcolor",t),this.$button.setIcon('<i class="re-icon-fontcolor"></i>'),this.$button.setDropdown(e)},_buildDropdown:function(){var t=c.dom('<div class="redactor-dropdown-cells">');return this.$selector=this._buildSelector(),this.$selectorText=this._buildSelectorItem("text",this.lang.get("text")),this.$selectorText.addClass("active"),this.$selectorBack=this._buildSelectorItem("back",this.lang.get("highlight")),this.$selector.append(this.$selectorText),this.$selector.append(this.$selectorBack),this.$pickerText=this._buildPicker("textcolor"),this.$pickerBack=this._buildPicker("backcolor"),t.append(this.$selector),t.append(this.$pickerText),t.append(this.$pickerBack),this._buildSelectorEvents(),t.width(242),t},_buildSelector:function(){var t=c.dom("<div>");return t.addClass("redactor-dropdown-selector"),t},_buildSelectorItem:function(t,e){var i=c.dom("<span>");return i.attr("rel",t).html(e),i.addClass("redactor-dropdown-not-close"),i},_buildSelectorEvents:function(){this.$selectorText.on("mousedown",function(t){t.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerBack.hide(),this.$pickerText.show(),this.$selectorText.addClass("active")}.bind(this)),this.$selectorBack.on("mousedown",function(t){t.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerText.hide(),this.$pickerBack.show(),this.$selectorBack.addClass("active")}.bind(this))},_buildPicker:function(t){for(var e=c.dom('<div class="re-dropdown-box-'+t+'">'),i="backcolor"==t?"background-color":"color",s=this.colors.length,n=this,o=function(t){t.preventDefault();var e=c.dom(t.target);n._set(e.data("rule"),e.attr("rel"))},a=0;a<s;a++){var r=this.colors[a],l=c.dom("<span>");l.attr({rel:r,"data-rule":i}),l.css({"background-color":r,"font-size":0,border:"2px solid #fff",width:"22px",height:"22px"}),l.on("mousedown",o),e.append(l)}var d=c.dom("<a>");return d.attr({href:"#"}),d.css({display:"block",clear:"both",padding:"8px 5px","font-size":"12px","line-height":1}),d.html(this.lang.get("none")),d.on("click",function(t){t.preventDefault(),n._remove(i)}),e.append(d),"backcolor"==t&&e.hide(),e},_set:function(t,e){var i={};i[t]=e;var s={tag:"span",style:i,type:"toggle"};this.inline.format(s)},_remove:function(t){this.inline.remove({style:t})}})}(Redactor),Redactor.add("plugin","fontfamily",{translations:{en:{fontfamily:"Font","remove-font-family":"Remove Font Family"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.inline=t.inline,this.toolbar=t.toolbar,this.fonts=this.opts.fontfamily?this.opts.fontfamily:["Arial","Helvetica","Georgia","Times New Roman","Monospace"]},start:function(){for(var t={},e=0;e<this.fonts.length;e++){var i=this.fonts[e];t[e]={title:i.replace(/'/g,""),api:"plugin.fontfamily.set",args:i}}t.remove={title:this.lang.get("remove-font-family"),api:"plugin.fontfamily.remove"};var s=this.toolbar.addButton("fontfamily",{title:this.lang.get("fontfamily")});s.setIcon('<i class="re-icon-fontfamily"></i>'),s.setDropdown(t)},set:function(t){var e={tag:"span",style:{"font-family":t},type:"toggle"};this.inline.format(e)},remove:function(){this.inline.remove({style:"font-family"})}}),Redactor.add("plugin","fontsize",{translations:{en:{size:"Size","remove-size":"Remove Font Size"}},init:function(t){this.app=t,this.lang=t.lang,this.inline=t.inline,this.toolbar=t.toolbar,this.sizes=[10,11,12,14,16,18,20,24,28,30]},start:function(){for(var t={},e=0;e<this.sizes.length;e++){var i=this.sizes[e];t[e]={title:i+"px",api:"plugin.fontsize.set",args:i}}t.remove={title:this.lang.get("remove-size"),api:"plugin.fontsize.remove"};var s=this.toolbar.addButton("fontsize",{title:this.lang.get("size")});s.setIcon('<i class="re-icon-fontsize"></i>'),s.setDropdown(t)},set:function(t){var e={tag:"span",style:{"font-size":t+"px"},type:"toggle"};this.inline.format(e)},remove:function(){this.inline.remove({style:"font-size"})}}),function(s){s.add("plugin","fullscreen",{translations:{en:{fullscreen:"Fullscreen"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.$win=t.$win,this.$doc=t.$doc,this.$body=t.$body,this.editor=t.editor,this.toolbar=t.toolbar,this.container=t.container,this.selection=t.selection,this.isOpen=!1,this.docScroll=0},start:function(){var t={title:this.lang.get("fullscreen"),api:"plugin.fullscreen.toggle"};this.toolbar.addButton("fullscreen",t).setIcon('<i class="re-icon-expand"></i>'),this.$target=this.toolbar.isTarget()?this.toolbar.getTargetElement():this.$body,this.opts.fullscreen&&this.toggle()},toggle:function(){return this.isOpen?this.close():this.open()},open:function(){this.docScroll=this.$doc.scrollTop(),this._createPlacemarker(),this.selection.save();var t=this.container.getElement(),e=this.editor.getElement(),i=this.toolbar.isTarget()?s.dom("body, html"):this.$target;this.opts.toolbarExternal&&this._buildInternalToolbar(),this.$target.prepend(t),this.$target.addClass("redactor-body-fullscreen"),t.addClass("redactor-box-fullscreen"),this.isTarget&&t.addClass("redactor-box-fullscreen-target"),i.css("overflow","hidden"),this.opts.maxHeight&&e.css("max-height",""),this.opts.minHeight&&e.css("min-height",""),this._resize(),this.$win.on("resize.redactor-plugin-fullscreen",this._resize.bind(this)),this.$doc.scrollTop(0),this.toolbar.getButton("fullscreen").setIcon('<i class="re-icon-retract"></i>'),this.selection.restore(),this.isOpen=!0,this.opts.zindex=1051},close:function(){this.isOpen=!1,this.opts.zindex=!1,this.selection.save();var t=this.container.getElement(),e=this.editor.getElement(),i=s.dom("body, html");this.opts.toolbarExternal&&this._buildExternalToolbar(),this.$target.removeClass("redactor-body-fullscreen"),this.$win.off("resize.redactor-plugin-fullscreen"),i.css("overflow",""),t.removeClass("redactor-box-fullscreen redactor-box-fullscreen-target"),e.css("height","auto"),this.opts.minHeight&&e.css("minHeight",this.opts.minHeight),this.opts.maxHeight&&e.css("maxHeight",this.opts.maxHeight),this.toolbar.getButton("fullscreen").setIcon('<i class="re-icon-expand"></i>'),this._removePlacemarker(t),this.selection.restore(),this.$doc.scrollTop(this.docScroll)},_resize:function(){var t=this.toolbar.getElement(),e=this.editor.getElement(),i=this.$win.height()-t.height();e.height(i)},_buildInternalToolbar:function(){var t=this.toolbar.getWrapper(),e=this.toolbar.getElement();t.addClass("redactor-toolbar-wrapper"),t.append(e),e.removeClass("redactor-toolbar-external"),$container.prepend(t)},_buildExternalToolbar:function(){var t=this.toolbar.getWrapper(),e=this.toolbar.getElement();this.$external=s.dom(this.opts.toolbarExternal),e.addClass("redactor-toolbar-external"),this.$external.append(e),t.remove()},_createPlacemarker:function(){var t=this.container.getElement();this.$placemarker=s.dom("<span />"),t.after(this.$placemarker)},_removePlacemarker:function(t){this.$placemarker.before(t),this.$placemarker.remove()}})}(Redactor),function(l){l.add("plugin","handle",{init:function(t){this.app=t,this.opts=t.opts,this.$doc=t.$doc,this.$body=t.$body,this.editor=t.editor,this.marker=t.marker,this.keycodes=t.keycodes,this.container=t.container,this.selection=t.selection,this.handleTrigger=void 0!==this.opts.handleTrigger?this.opts.handleTrigger:"@",this.handleStart=void 0!==this.opts.handleStart?this.opts.handleStart:0,this.handleStr="",this.handleLen=this.handleStart},start:function(){this.opts.handle&&this.editor.getElement().on("keyup.redactor-plugin-handle",this._handle.bind(this))},stop:function(){this.editor.getElement().off(".redactor-plugin-handle"),this.$doc.off(".redactor-plugin-handle"),l.dom("#redactor-handle-list").remove()},_handle:function(t){var e=t.which,i=t.ctrlKey||t.metaKey;if(e===this.keycodes.BACKSPACE){if(!(this._isShown()&&this.handleLen>this.handleStart))return;this.handleLen=this.handleLen-2,this.handleLen<=this.handleStart&&this._hide()}if(e!==this.keycodes.DELETE&&e!==this.keycodes.ESC&&e!==this.keycodes.SHIFT&&!i&&-1===[37,38,39,40].indexOf(e)){var s=new RegExp("^"+this.handleTrigger);this.handleStr=this.selection.getTextBeforeCaret(this.handleLen+1),s.test(this.handleStr)&&(this.handleStr=this.handleStr.replace(this.handleTrigger,""),this.handleLen++,this._load())}},_load:function(){l.ajax.post({url:this.opts.handle,data:"handle="+this.handleStr,success:this._parse.bind(this)})},_parse:function(t){if(""!==t){var e="object"==typeof t?t:JSON.parse(t);this._build(),this._buildData(e)}},_build:function(){this.$list=l.dom("#redactor-handle-list"),0===this.$list.length&&(this.$list=l.dom('<div id="redactor-handle-list">'),this.$body.append(this.$list))},_buildData:function(t){this.data=t,this._update(),this._show()},_update:function(){for(var t in this.$list.html(""),this.data){var e=l.dom('<a href="#">');e.html(this.data[t].item),e.attr("data-key",t),e.on("click",this._replace.bind(this)),this.$list.append(e)}this.container.getElement().offset();var i=this.selection.getPosition();this.$list.css({top:i.top+i.height+this.$doc.scrollTop()+"px",left:i.left+"px"})},_isShown:function(){return this.$list&&this.$list.hasClass("open")},_show:function(){this.$list.addClass("open"),this.$list.show(),this.$doc.off(".redactor-plugin-handle"),this.$doc.on("click.redactor-plugin-handle keydown.redactor-plugin-handle",this._hide.bind(this))},_hide:function(t){var e=!1,i=t&&t.which;t&&"click"!==t.type&&i!==this.keycodes.ESC&&i!==this.keycodes.ENTER&&i!==this.keycodes.SPACE||(e=!0),e&&(this.$list.removeClass("open"),this.$list.hide(),this._reset())},_reset:function(){this.handleStr="",this.handleLen=this.handleStart},_replace:function(t){t.preventDefault();var e=l.dom(t.target).attr("data-key"),i=this.data[e].replacement,s=this.marker.insert("start"),n=l.dom(s),o=s.previousSibling,a=o.textContent,r=new RegExp("@"+this.handleStr+"$");a=a.replace(r,""),o.textContent=a,n.before(i),this.selection.restoreMarkers()}})}(Redactor),function(o){o.add("plugin","imagemanager",{translations:{en:{choose:"Choose"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts},onmodal:{image:{open:function(t,e){this.opts.imageManagerJson&&this._load(t)}}},_load:function(t){var e=t.getBody();this.$box=o.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),e.append(this.$box),o.ajax.get({url:this.opts.imageManagerJson,success:this._parse.bind(this)})},_parse:function(t){for(var e in t){var i=t[e];if("object"==typeof i){var s=o.dom("<img>"),n=i.thumb?i.thumb:i.url;s.attr("src",n),s.attr("data-params",encodeURI(JSON.stringify(i))),s.css({width:"96px",height:"72px",margin:"0 4px 2px 0",cursor:"pointer"}),s.on("click",this._insert.bind(this)),this.$box.append(s)}}},_insert:function(t){t.preventDefault();var e=o.dom(t.target),i=JSON.parse(decodeURI(e.attr("data-params")));this.app.api("module.image.insert",{image:i})}})}(Redactor),Redactor.add("plugin","inlinestyle",{translations:{en:{style:"Style"}},init:function(t){this.app=t,this.lang=t.lang,this.toolbar=t.toolbar,this.styles={marked:{title:"Marked",args:"mark"},code:{title:"Code",args:"code"},variable:{title:"Variable",args:"var"},shortcut:{title:"Shortcut",args:"kbd"},sup:{title:"Superscript",args:"sup"},sub:{title:"Subscript",args:"sub"}}},start:function(){var t={};for(var e in this.styles){var i=this.styles[e];t[e]={title:i.title,api:"module.inline.format",args:i.args}}var s=this.toolbar.addButtonAfter("format","inline",{title:this.lang.get("style")});s.setIcon('<i class="re-icon-inline"></i>'),s.setDropdown(t)}}),Redactor.add("plugin","limiter",{init:function(t){this.app=t,this.utils=t.utils,this.opts=t.opts,this.editor=t.editor,this.keycodes=t.keycodes},onpasting:function(t){if(this.opts.limiter){t=this.utils.removeInvisibleChars(t);var e=this._getText(),i=t.length+e.length;this.opts.input=!(i>=this.opts.limiter)}},start:function(){this.opts.limiter&&(this._count(),this.editor.getElement().on("keydown.redactor-plugin-limiter",this._limit.bind(this)))},stop:function(){this.editor.getElement().off(".redactor-plugin-limiter"),this.opts.input=!0},_limit:function(t){var e=t.which,i=t.ctrlKey||t.metaKey;e===this.keycodes.BACKSPACE||e===this.keycodes.DELETE||e===this.keycodes.ESC||e===this.keycodes.SHIFT||i&&65===e||i&&88===e||i&&82===e||i&&116===e||-1!==[37,38,39,40].indexOf(e)||this._count(t)},_count:function(t){if(this._getText().length>=this.opts.limiter)return t&&t.preventDefault(),this.opts.input=!1;this.opts.input=!0},_getText:function(){var t=this.editor.getElement().text();return this.utils.removeInvisibleChars(t)}}),function(n){n.add("plugin","properties",{modals:{properties:'<form action="">                     <div class="form-item">                         <label>Id</label>                         <input type="text" name="id">                     </div>                     <div class="form-item">                         <label>Class</label>                         <input type="text" name="classname">                     </div>                 </form>'},translations:{en:{properties:"Properties"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.$body=t.$body,this.toolbar=t.toolbar,this.inspector=t.inspector,this.selection=t.selection,this.labelStyle={"font-family":"monospace",position:"absolute",padding:"2px 5px","line-height":1,"border-radius":"3px","font-size":"11px",color:"rgba(255, 255, 255, .9)"}},onmodal:{properties:{open:function(t,e){if(this.$block){var i=this._getData(this.$block);e.setData(i)}},opened:function(t,e){e.getField("id").focus()},save:function(t,e){var i=e.getData();this._save(i)}}},onbutton:{properties:{observe:function(t){this._observeButton(t)}}},start:function(){var t={title:this.lang.get("properties"),api:"plugin.properties.open",observe:"properties"};this.toolbar.addButton("properties",t).setIcon('<i class="re-icon-properties"></i>'),this._createLabel()},stop:function(){this._removeLabel()},open:function(){var t=this.selection.getBlock();if(t){this.$block=n.dom(t);var e={title:this.lang.get("properties"),width:"500px",name:"properties",handle:"save",commands:{save:{title:this.lang.get("save")},cancel:{title:this.lang.get("cancel")}}};this.app.api("module.modal.build",e)}},_save:function(t){this.app.api("module.modal.close"),""===t.id?this.$block.removeAttr("id"):this.$block.attr("id",t.id),""===t.classname?this.$block.removeAttr("class"):this.$block.attr("class",t.classname)},_getData:function(t){var e=n.dom(t);return{id:e.attr("id"),classname:e.attr("class")}},_showData:function(t,e){var i="";if(e.id&&(i+="#"+e.id+" "),e.classname&&(i+="."+e.classname),""!==i){var s=n.dom(t).offset();this.$label.css({top:s.top-12+"px",left:s.left+"px","z-index":this.opts.zindex?this.opts.zindex+3:"auto"}),this.$label.html(i),this.$label.show()}else this.$label.hide()},_createLabel:function(){this.$label=n.dom("<span />"),this.$label.hide(),this.$label.css(this.labelStyle).css("background","rgba(229, 57, 143, .7)"),this.$body.append(this.$label)},_removeLabel:function(){this.$label&&this.$label.remove()},_observeButton:function(t){var e=this.selection.getBlock(),i=this.inspector.parse(e);if(e&&!i.isComponent()){var s=this._getData(e);this._showData(e,s),t.enable()}else t.disable(),this.$label&&this.$label.hide()}})}(Redactor),function(o){o.add("plugin","specialchars",{translations:{en:{specialchars:"Special Characters"}},init:function(t){this.app=t,this.lang=t.lang,this.toolbar=t.toolbar,this.insertion=t.insertion,this.chars=["&lsquo;","&rsquo;","&ldquo;","&rdquo;","&ndash;","&mdash;","&divide;","&hellip;","&trade;","&bull;","&rarr;","&asymp;","$","&euro;","&cent;","&pound;","&yen;","&iexcl;","&curren;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&raquo;","&not;","&reg;","&macr;","&deg;","&sup1;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&ordm;","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&times;","&Oslash;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&OElig;","&oelig;","&#372;","&#374","&#373","&#375;"]},start:function(){var t={title:this.lang.get("specialchars")},e=this._buildDropdown();this.$button=this.toolbar.addButton("specialchars",t),this.$button.setIcon('<i class="re-icon-specialcharacters"></i>'),this.$button.setDropdown(e)},_set:function(t){this.insertion.insertChar(t)},_buildDropdown:function(){for(var i=this,t=o.dom('<div class="redactor-dropdown-cells">'),e=function(t){t.preventDefault();var e=o.dom(t.target);i._set(e.data("char"))},s=0;s<this.chars.length;s++){var n=o.dom("<a>");n.attr({href:"#","data-char":this.chars[s]}),n.css({"line-height":"32px",width:"32px",height:"32px"}),n.html(this.chars[s]),n.on("click",e),t.append(n)}return t}})}(Redactor),function(o){o.add("plugin","table",{translations:{en:{table:"Table","insert-table":"Insert table","insert-row-above":"Insert row above","insert-row-below":"Insert row below","insert-column-left":"Insert column left","insert-column-right":"Insert column right","add-head":"Add head","delete-head":"Delete head","delete-column":"Delete column","delete-row":"Delete row","delete-table":"Delete table"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts,this.caret=t.caret,this.editor=t.editor,this.toolbar=t.toolbar,this.component=t.component,this.inspector=t.inspector,this.insertion=t.insertion,this.selection=t.selection},ondropdown:{table:{observe:function(t){this._observeDropdown(t)}}},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"table")},start:function(){var t={observe:"table","insert-table":{title:this.lang.get("insert-table"),api:"plugin.table.insert"},"insert-row-above":{title:this.lang.get("insert-row-above"),classname:"redactor-table-item-observable",api:"plugin.table.addRowAbove"},"insert-row-below":{title:this.lang.get("insert-row-below"),classname:"redactor-table-item-observable",api:"plugin.table.addRowBelow"},"insert-column-left":{title:this.lang.get("insert-column-left"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnLeft"},"insert-column-right":{title:this.lang.get("insert-column-right"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnRight"},"add-head":{title:this.lang.get("add-head"),classname:"redactor-table-item-observable",api:"plugin.table.addHead"},"delete-head":{title:this.lang.get("delete-head"),classname:"redactor-table-item-observable",api:"plugin.table.deleteHead"},"delete-column":{title:this.lang.get("delete-column"),classname:"redactor-table-item-observable",api:"plugin.table.deleteColumn"},"delete-row":{title:this.lang.get("delete-row"),classname:"redactor-table-item-observable",api:"plugin.table.deleteRow"},"delete-table":{title:this.lang.get("delete-table"),classname:"redactor-table-item-observable",api:"plugin.table.deleteTable"}},e={title:this.lang.get("table")},i=this.toolbar.addButtonBefore("link","table",e);i.setIcon('<i class="re-icon-table"></i>'),i.setDropdown(t)},insert:function(){for(var t=this.component.create("table"),e=0;e<2;e++)t.addRow(3);t=this.insertion.insertHtml(t),this.caret.setStart(t)},addRowAbove:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=t.addRowTo(e,"before");this.caret.setStart(i)}},addRowBelow:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=t.addRowTo(e,"after");this.caret.setStart(i)}},addColumnLeft:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent();this.selection.save(),t.addColumnTo(e,"left"),this.selection.restore()}},addColumnRight:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent();this.selection.save(),t.addColumnTo(e,"right"),this.selection.restore()}},addHead:function(){var t=this._getComponent();t&&(this.selection.save(),t.addHead(),this.selection.restore())},deleteHead:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent();0!==o.dom(e).closest("thead").length?(t.removeHead(),this.caret.setStart(t)):(this.selection.save(),t.removeHead(),this.selection.restore())}},deleteColumn:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=o.dom(e).closest("td, th"),s=i.nextElement().get(),n=i.prevElement().get();t.removeColumn(e),s?this.caret.setStart(s):n?this.caret.setEnd(n):this.deleteTable()}},deleteRow:function(){var t=this._getComponent();if(t){var e=this.selection.getCurrent(),i=o.dom(e).closest("tr"),s=i.nextElement().get(),n=i.prevElement().get();t.removeRow(e),s?this.caret.setStart(s):n?this.caret.setEnd(n):this.deleteTable()}},deleteTable:function(){var t=this._getTable();t&&this.component.remove(t)},_getTable:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isTable())return e.getTable()},_getComponent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isTable()){var i=e.getTable();return this.component.create("table",i)}},_observeDropdown:function(t){var e=this._getTable(),i=t.getItemsByClass("redactor-table-item-observable"),s=t.getItem("insert-table");e?(this._observeItems(i,"enable"),s.disable()):(this._observeItems(i,"disable"),s.enable())},_observeItems:function(t,e){for(var i=0;i<t.length;i++)t[i][e]()}})}(Redactor),function(a){a.add("class","table.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,e&&void 0!==e.cmnt?e:this._init(e)},addHead:function(){this.removeHead();var t=this.$element.find("tr").first().children("td, th").length,e=a.dom("<thead>"),i=this._buildRow(t,"<th>");e.append(i),this.$element.prepend(e)},addRow:function(t){var e=this._buildRow(t);return this.$element.append(e),e},addRowTo:function(t,e){return this._addRowTo(t,e)},addColumnTo:function(t,n){var e=a.dom(t),i=e.closest("tr"),s=e.closest("td, th"),o=0;i.find("td, th").each(function(t,e){t===s.get()&&(o=e)}),this.$element.find("tr").each(function(t){var e=a.dom(t).find("td, th").get(o),i=a.dom(e),s=i.clone();s.html(""),"right"===n?i.after(s):i.before(s)})},removeHead:function(){var t=this.$element.find("thead");0!==t.length&&t.remove()},removeRow:function(t){a.dom(t).closest("tr").remove()},removeColumn:function(t){var e=a.dom(t),i=e.closest("tr"),s=e.closest("td, th"),n=0;i.find("td, th").each(function(t,e){t===s.get()&&(n=e)}),this.$element.find("tr").each(function(t){var e=a.dom(t).find("td, th").get(n);a.dom(e).remove()})},_init:function(t){var e,i;if(void 0!==t){var s=a.dom(t),n=s.get(),o=s.closest("figure");0!==o.length?i=(e=o).find("table").get():"TABLE"===n.tagName&&(i=n)}this._buildWrapper(e),this._buildElement(i),this._initWrapper()},_addRowTo:function(t,e){var i=a.dom(t).closest("tr");if(0!==i.length){var s=i.children("td, th").length,n=this._buildRow(s);return i[e](n),n}},_buildRow:function(t,e){e=e||"<td>";for(var i=a.dom("<tr>"),s=0;s<t;s++){var n=a.dom(e);n.attr("contenteditable",!0),i.append(n)}return i},_buildElement:function(t){t?this.$element=a.dom(t):(this.$element=a.dom("<table>"),this.append(this.$element))},_buildWrapper:function(t){t=t||"<figure>",this.parse(t)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"table",tabindex:"-1",contenteditable:!1}),this.app.detector.isIe()&&this.removeAttr("contenteditable")}})}(Redactor),function(s){s.add("plugin","textdirection",{translations:{en:{"change-text-direction":"RTL-LTR","left-to-right":"Left to Right","right-to-left":"Right to Left"}},init:function(t){this.app=t,this.lang=t.lang,this.block=t.block,this.toolbar=t.toolbar,this.selection=t.selection},start:function(){var t={};t.ltr={title:this.lang.get("left-to-right"),api:"plugin.textdirection.set",args:"ltr"},t.rtl={title:this.lang.get("right-to-left"),api:"plugin.textdirection.set",args:"rtl"};var e=this.toolbar.addButton("textdirection",{title:this.lang.get("change-text-direction")});e.setIcon('<i class="re-icon-textdirection"></i>'),e.setDropdown(t)},set:function(t){var e=this.selection.getBlock();if(e&&"LI"===e.tagName){var i=s.dom(e).parents("ul, ol",".redactor-in").last();this.block.add({attr:{dir:t}},!1,i)}else this.block.add({attr:{dir:t}})}})}(Redactor),Redactor.add("plugin","textexpander",{init:function(t){this.app=t,this.opts=t.opts,this.utils=t.utils,this.editor=t.editor,this.marker=t.marker,this.keycodes=t.keycodes,this.selection=t.selection},start:function(){this.opts.textexpander&&this.editor.getElement().on("keyup.redactor-plugin-textexpander",this._expand.bind(this))},stop:function(){this.editor.getElement().off(".redactor-plugin-textexpander")},_expand:function(t){if(t.which===this.keycodes.SPACE)for(var e=this.opts.textexpander.length,i=0;i<e;i++){var s=this.opts.textexpander[i],n=new RegExp(this.utils.escapeRegExp(s[0])+"\\s$"),o=this.selection.getTextBeforeCaret(s[0].length+1).replace(/\s$/,"");if(s[0]===o)return this._replaceSelection(n,s[1])}},_replaceSelection:function(t,e){var i=this.marker.insert("start").previousSibling,s=i.textContent;s=(s=s.replace(/&nbsp;/," ")).replace(t,e),i.textContent=s,this.selection.restoreMarkers()}}),function(r){r.add("plugin","variable",{translations:{en:{change:"Change",variable:"Variable","variable-select":"Please, select a variable"}},modals:{variable:""},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts,this.toolbar=t.toolbar,this.component=t.component,this.insertion=t.insertion,this.inspector=t.inspector,this.selection=t.selection},onmodal:{variable:{open:function(t,e){this._build(t)}}},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("variable")){var s=i.getComponent(),n={change:{title:this.lang.get("change"),api:"plugin.variable.open",args:s},remove:{title:this.lang.get("delete"),api:"plugin.variable.remove",args:s}};e.set(t,s,n,"bottom")}},start:function(){if(this.opts.variables){var t={title:this.lang.get("variable"),api:"plugin.variable.open"};this.toolbar.addButton("variable",t).setIcon('<i class="re-icon-variable"></i>')}},open:function(){var t={title:this.lang.get("variable"),width:"600px",name:"variable"};this.$currentItem=this._getCurrent(),this.app.api("module.modal.build",t)},insert:function(t){this.app.api("module.modal.close");var e=t.attr("data-type"),i=this.component.create("variable");i.html(e),this.insertion.insertRaw(i)},remove:function(t){this.component.remove(t)},_getCurrent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isComponentType("variable"))return this.component.build(e.getComponent())},_build:function(t){var e=t.getBody(),i=this._buildLabel(),s=this._buildList();this._buildItems(s),e.html(""),e.append(i),e.append(s)},_buildLabel:function(){var t=r.dom("<label>");return t.html(this.lang.parse("## variable-select ##:")),t},_buildList:function(){var t=r.dom("<ul>");return t.addClass("redactor-variables-list"),t},_buildItems:function(t){for(var e=this._getCurrentType(),i=this.opts.variables,s=0;s<i.length;s++){var n=i[s].trim(),o=r.dom("<li>"),a=r.dom("<span>");a.attr("data-type",n),a.html(n),a.on("click",this._toggle.bind(this)),e===n&&a.addClass("redactor-variables-item-selected"),o.append(a),t.append(o)}},_getCurrentType:function(){return!!this.$currentItem&&this.$currentItem.getData().type},_toggle:function(t){var e=r.dom(t.target);this.app.api("plugin.variable.insert",e)}})}(Redactor),Redactor.add("class","variable.component",{mixins:["dom","component"],init:function(t,e){return this.app=t,this.utils=t.utils,e&&void 0!==e.cmnt?e:this._init(e)},getData:function(){return{type:this._getType()}},_init:function(t){t=t||"<span>",this.parse(t),this._initWrapper()},_getType:function(){var t=this.text().trim();return this.utils.removeInvisibleChars(t)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"variable",tabindex:"-1",contenteditable:!1})}}),Redactor.add("plugin","video",{translations:{en:{video:"Video","video-html-code":"Video Embed Code or Youtube/Vimeo Link"}},modals:{video:'<form action="">                     <div class="form-item">                         <label for="modal-video-input">## video-html-code ##</label>                         <textarea id="modal-video-input" name="video" style="height: 160px;"></textarea>                     </div>                 </form>'},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts,this.toolbar=t.toolbar,this.component=t.component,this.insertion=t.insertion,this.inspector=t.inspector},onmodal:{video:{opened:function(t,e){e.getField("video").focus()},insert:function(t,e){var i=e.getData();this._insert(i)}}},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(i.isComponentType("video")){var s=i.getComponent(),n={remove:{title:this.lang.get("delete"),api:"plugin.video.remove",args:s}};e.set(t,s,n,"bottom")}},start:function(){var t={title:this.lang.get("video"),api:"plugin.video.open"};this.toolbar.addButtonAfter("image","video",t).setIcon('<i class="re-icon-video"></i>')},open:function(){var t={title:this.lang.get("video"),width:"600px",name:"video",handle:"insert",commands:{insert:{title:this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}}};this.app.api("module.modal.build",t)},remove:function(t){this.component.remove(t)},_insert:function(t){if(this.app.api("module.modal.close"),""!==t.video.trim()&&(t.video=this._matchData(t.video),this._isVideoIframe(t.video))){var e=this.component.create("video",t.video);this.insertion.insertHtml(e)}},_isVideoIframe:function(t){return null!==t.match(/<iframe|<video/gi)},_matchData:function(t){var e='<iframe style="width: 500px; height: 281px;" src="',i='" frameborder="0" allowfullscreen></iframe>';if(this._isVideoIframe(t)){var s=["iframe","video","source"];t=(t=t.replace(/<p(.*?[^>]?)>([\w\W]*?)<\/p>/gi,"")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return-1===s.indexOf(e.toLowerCase())?"":t})}else t.match(this.opts.regex.youtube)?t=t.replace(this.opts.regex.youtube,e+"//www.youtube.com/embed/$1"+i):t.match(this.opts.regex.vimeo)&&(t=t.replace(this.opts.regex.vimeo,e+"//player.vimeo.com/video/$2"+i));return t}}),Redactor.add("plugin","widget",{translations:{en:{widget:"Widget","widget-html-code":"Widget HTML Code"}},modals:{widget:'<form action="">                     <div class="form-item">                         <label for="modal-widget-input">## widget-html-code ##</label>                         <textarea id="modal-widget-input" name="widget" style="height: 200px;"></textarea>                     </div>                 </form>'},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts,this.toolbar=t.toolbar,this.component=t.component,this.insertion=t.insertion,this.inspector=t.inspector,this.selection=t.selection},onmodal:{widget:{opened:function(t,e){if(e.getField("widget").focus(),this.$currentItem){var i=decodeURI(this.$currentItem.attr("data-widget-code"));e.getField("widget").val(i)}},insert:function(t,e){var i=e.getData();this._insert(i)}}},oncontextbar:function(t,e){var i=this.inspector.parse(t.target);if(!i.isFigcaption()&&i.isComponentType("widget")){var s=i.getComponent(),n={edit:{title:this.lang.get("edit"),api:"plugin.widget.open",args:s},remove:{title:this.lang.get("delete"),api:"plugin.widget.remove",args:s}};e.set(t,s,n,"bottom")}},onbutton:{widget:{observe:function(t){this._observeButton(t)}}},start:function(){var t={title:this.lang.get("widget"),api:"plugin.widget.open",observe:"widget"};this.toolbar.addButton("widget",t).setIcon('<i class="re-icon-widget"></i>')},open:function(){this.$currentItem=this._getCurrent();var t={title:this.lang.get("widget"),width:"600px",name:"widget",handle:"insert",commands:{insert:{title:this.$currentItem?this.lang.get("save"):this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}}};this.app.api("module.modal.build",t)},remove:function(t){this.component.remove(t)},_getCurrent:function(){var t=this.selection.getCurrent(),e=this.inspector.parse(t);if(e.isComponentType("widget"))return this.component.build(e.getComponent())},_insert:function(t){if(this.app.api("module.modal.close"),""!==t.widget.trim()){var e=this._isHtmlString(t.widget)?t.widget:document.createTextNode(t.widget),i=this.component.create("widget",e);i.attr("data-widget-code",encodeURI(t.widget.trim())),this.insertion.insertHtml(i)}},_isHtmlString:function(t){return!("string"==typeof t&&!/^\s*<(\w+|!)[^>]*>/.test(t))},_observeButton:function(t){var e=this.selection.getCurrent();this.inspector.parse(e).isComponentType("table")?t.disable():t.enable()}});
//# sourceMappingURL=plugins.min.js.map