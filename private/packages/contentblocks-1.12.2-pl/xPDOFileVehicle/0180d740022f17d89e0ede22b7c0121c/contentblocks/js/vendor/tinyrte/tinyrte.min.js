/*
 *  Yellow Text - v0.5.0
 *  Yellow Text is a beautiful text editor which makes creating content fun again. It ships with a beautiful theme and really clever shortkeys.
 *  https://github.com/stefanvermaas/yellow-text
 *
 *  Made by Stefan Vermaas
 *  Under BEERWARE License
 */
!function(a,b,c){function d(){}function e(b,c){this.element=b,this.options=a.extend({},g,c),this._defaults=g,this._name=f,this.initialize()}var f="TinyRTE",g={width:"100%",height:"300px",containerClass:"tinyrte-container",buttonsClass:"tinyrte-buttons",iFrameClass:"tinyrte-iframe",cleanOnSubmit:!0,defaultFont:"Helvetica Neue, Helvetica, arial, sans-serief",defaultFontSize:"1em",defaultFontColor:"#000000",defaultActions:["bold","underline","italic","strikethrough","align-left","align-center","align-right","unordered-list","ordered-list","link","image"],isContentChanged:d};e.prototype={initialize:function(){this.render(),this.setContentToEditor(this.getContentFromTextarea()),this.events()},setContentToEditor:function(b){return a(this.editor).contents().find("body > div").append(b),b},setContentToTextarea:function(b){return a(this.element).val(b),b},getContentFromTextarea:function(){return a(this.element).val()},getContentFromEditor:function(){return a(this.editor).contents().find("body > div").html()},render:function(){var b=[],c=a(this.element);a.each(["background","font","border","border-radius","box-shadow","box-sizing","padding","direction","height","width","text-align","text-decoration","text-shadow","word-spacing","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-color","border-right-color","border-bottom-color","border-left-color"],function(a,d){var e=c.css(d);b.push(d+":"+e+";")}),b.push("margin: 0;"),b=b.join(""),a(this.element).hide(),this.container=a("<div />").addClass(this.options.containerClass),a(this.element).after(this.container),this.editor=a("<iframe />").addClass(this.options.iFrameClass).css({width:"100%",height:c.outerHeight()+1,border:0}).appendTo(this.container).get(0),this.editor.contentWindow.document.open(),this.editor.contentWindow.document.close(),this.editor.contentWindow.document.designMode="on";var d=a("<div />").attr("style",b);a(this.editor).contents().find("body").append(d).css({whiteSpace:"nowrap"});var e='<style type="text/css">* {box-sizing: border-box;} html, body {border: 0; margin: 0; padding: 0;}</style>';a(this.editor).contents().find("head").append(e);var f=c.css("z-index");"auto"===f&&(f=0),f++,this.buttons=a("<div />").addClass(this.options.buttonsClass).css("z-index",f).prependTo(this.container),this.createButtons()},createButtons:function(){for(var b=0;b<this.options.defaultActions.length;b++){var c;switch(this.options.defaultActions[b]){case"bold":c={content:"b",command:"bold"};break;case"underline":c={content:"u",command:"underline"};break;case"italic":c={content:"i",command:"italic"};break;case"strikethrough":c={content:"s",command:"strikethrough"};break;case"align-left":c={content:"left",command:"JustifyLeft"};break;case"align-center":c={content:"center",command:"JustifyCenter"};break;case"align-right":c={content:"right",command:"JustifyRight"};break;case"unordered-list":c={content:"ul",command:"InsertUnorderedList"};break;case"ordered-list":c={content:"ol",command:"InsertOrderedList"};break;case"image":c={content:"img",command:"image"};break;case"link":c={content:"link",command:"link"};break;default:c={content:"",command:""}}a("<a />").addClass(c.command).text(c.content).data("command",c.command).appendTo(this.buttons)}},events:function(){var b=this;a("."+this.options.buttonsClass+" a").on("click",function(c){var d=a(this).data("command");b.buttonClicked(c,d)}),a(this.editor).contents().find("body").on("keydown",function(a){return 13===a.keyCode?!1:void((a.ctrlKey||a.metaKey)&&b.shortkey(a,this))}),a(this.editor).contents().find("body").on("paste",function(a){a.preventDefault();var d=a.originalEvent.clipboardData.getData("text/plain"),e=c.createElement("div");e.innerHTML=d,d=e.textContent.replace(/\r?\n|\r/g,""),b.runCMD("insertText",d)}),a(this.editor).contents().find("body").on("keyup",function(){var c=a(b.editor).contents().find("body").html()!==a(b.element).text()?!0:!1;b.options.isContentChanged(c),c&&(b.cleanTheCode(),b.setContentToTextarea(b.getContentFromEditor()))}),a(this.element).parents("form").on("submit",function(){b.cleanTheCode(),b.setContentToTextarea(b.getContentFromEditor())})},buttonClicked:function(a,b){this.editor.contentWindow.focus(),this.runCMD(b),this.editor.contentWindow.focus()},shortkey:function(a){var b=a.which;if(66===b||73===b||85===b){switch(this.editor.contentWindow.focus(),b){case 66:this.runCMD("bold");break;case 73:this.runCMD("italic");break;case 85:this.runCMD("underline")}this.editor.contentWindow.focus()}},runCMD:function(a,b){var c=!1;if("image"===a){var d;"function"==typeof this.options.setImage&&(d=this.options.setImage.call());var e="undefined"!=typeof d&&d.length>0?d:prompt("URL (example: http://www.google.com): ");c=this.editor.contentWindow.document.execCommand("InsertImage",!1,e)}else if("link"===a){var f=prompt("URL (example: http://www.google.com): ");c=this.editor.contentWindow.document.execCommand("CreateLink",!1,f)}else c="insertText"===a?this.editor.contentWindow.document.execCommand(a,!1,b):this.editor.contentWindow.document.execCommand(a);return this.cleanTheCode(),this.setContentToTextarea(this.getContentFromEditor()),c},cleanTheCode:function(){var b=a(this.editor).contents().find("body").find("div");b.find("br").removeAttr("class").unwrap(),b.find("ul").removeAttr("class").unwrap(),b.find("ol").removeAttr("class").unwrap(),b.find("span").contents().unwrap()}},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);
